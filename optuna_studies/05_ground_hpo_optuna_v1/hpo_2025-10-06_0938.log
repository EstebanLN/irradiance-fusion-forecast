nohup: ignoring input
2025-10-06 09:38:59.019355: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-10-06 09:38:59.024586: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1759761539.030424 1218911 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1759761539.032429 1218911 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-10-06 09:38:59.039107: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE4.1 SSE4.2 AVX AVX2 AVX512F AVX512_VNNI AVX512_BF16 AVX_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Studies dir: /mnt/SOLARLAB/E_Ladino/Repo/irradiance-fusion-forecast/optuna_studies
Artifacts dir: /mnt/SOLARLAB/E_Ladino/Repo/irradiance-fusion-forecast/models/optuna_artifacts
Baseline → RMSE: 196.2835 | MAE: 102.1871
/mnt/SOLARLAB/E_Ladino/Repo/irradiance-fusion-forecast/Notebooks/05_ground_hpo_optuna_v1.py:141: FutureWarning: The import path :class:`~optuna.storages.JournalFileOpenLock` has been deprecated in v4.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v4.0.0. Use :class:`~optuna.storages.journal.JournalFileOpenLock` instead.
  file_storage = JournalFileStorage(str(log_path), lock_obj=JournalFileOpenLock(str(lock_path)))
/mnt/SOLARLAB/E_Ladino/Repo/irradiance-fusion-forecast/Notebooks/05_ground_hpo_optuna_v1.py:141: FutureWarning: JournalFileStorage has been deprecated in v4.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v4.0.0. Use :class:`~optuna.storages.journal.JournalFileBackend` instead.
  file_storage = JournalFileStorage(str(log_path), lock_obj=JournalFileOpenLock(str(lock_path)))
[I 2025-10-06 09:39:01,386] Using an existing study with name 'ground_trackA_mlp' instead of creating a new one.
Running Study A (MLP)…
  0%|          | 0/40 [00:00<?, ?it/s]I0000 00:00:1759761541.730751 1218911 gpu_device.cc:2022] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 21474 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 4090, pci bus id: 0000:01:00.0, compute capability: 8.9
I0000 00:00:1759761542.414521 1219050 service.cc:148] XLA service 0x71222000a710 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
I0000 00:00:1759761542.414549 1219050 service.cc:156]   StreamExecutor device (0): NVIDIA GeForce RTX 4090, Compute Capability 8.9
2025-10-06 09:39:02.424423: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:268] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
I0000 00:00:1759761542.461807 1219050 cuda_dnn.cc:529] Loaded cuDNN version 90101
I0000 00:00:1759761542.888770 1219050 device_compiler.h:188] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
                                      [I 2025-10-06 09:39:18,729] Trial 6 finished with value: 131.17293868687244 and parameters: {'n1': 192, 'n2': 96, 'do1': 0.36599697090570255, 'do2': 0.2993292420985183, 'lr': 0.00018410729205738696, 'l2': 6.02521573620385e-08, 'act': 'selu', 'batch': 256, 'epochs': 63}. Best is trial 1 with value: 130.37151691176643.
  0%|          | 0/40 [00:17<?, ?it/s]Best trial: 1. Best value: 130.372:   0%|          | 0/40 [00:17<?, ?it/s]Best trial: 1. Best value: 130.372:   2%|▎         | 1/40 [00:17<11:16, 17.34s/it]                                                                                  [I 2025-10-06 09:39:38,480] Trial 7 finished with value: 130.4450839314192 and parameters: {'n1': 128, 'n2': 32, 'do1': 0.15212112147976886, 'do2': 0.2623782158161189, 'lr': 0.0005418282319533242, 'l2': 2.8585493941961875e-07, 'act': 'relu', 'batch': 256, 'epochs': 97}. Best is trial 1 with value: 130.37151691176643.
Best trial: 1. Best value: 130.372:   2%|▎         | 1/40 [00:37<11:16, 17.34s/it]Best trial: 1. Best value: 130.372:   2%|▎         | 1/40 [00:37<11:16, 17.34s/it]Best trial: 1. Best value: 130.372:   5%|▌         | 2/40 [00:37<11:52, 18.76s/it]2025-10-06 09:39:40.596741: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_48', 24 bytes spill stores, 24 bytes spill loads

2025-10-06 09:39:40.653223: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_48', 388 bytes spill stores, 388 bytes spill loads

2025-10-06 09:39:41.105331: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_48', 48 bytes spill stores, 48 bytes spill loads

2025-10-06 09:39:41.172145: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_48', 404 bytes spill stores, 404 bytes spill loads

2025-10-06 09:40:16.316513: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_16', 24 bytes spill stores, 24 bytes spill loads

                                                                                  [I 2025-10-06 09:40:16,661] Trial 8 finished with value: 130.94762788993162 and parameters: {'n1': 320, 'n2': 32, 'do1': 0.3037724259507192, 'do2': 0.08526206184364576, 'lr': 0.00012897950480855554, 'l2': 0.000555172168524472, 'act': 'relu', 'batch': 128, 'epochs': 94}. Best is trial 1 with value: 130.37151691176643.
Best trial: 1. Best value: 130.372:   5%|▌         | 2/40 [01:15<11:52, 18.76s/it]Best trial: 1. Best value: 130.372:   5%|▌         | 2/40 [01:15<11:52, 18.76s/it]Best trial: 1. Best value: 130.372:   8%|▊         | 3/40 [01:15<17:02, 27.63s/it]                                                                                  [I 2025-10-06 09:40:40,642] Trial 9 pruned. Trial was pruned at epoch 63.
Best trial: 1. Best value: 130.372:   8%|▊         | 3/40 [01:39<17:02, 27.63s/it]Best trial: 1. Best value: 130.372:   8%|▊         | 3/40 [01:39<17:02, 27.63s/it]Best trial: 1. Best value: 130.372:  10%|█         | 4/40 [01:39<15:42, 26.19s/it]                                                                                  [I 2025-10-06 09:40:44,022] Trial 10 pruned. Trial was pruned at epoch 5.
Best trial: 1. Best value: 130.372:  10%|█         | 4/40 [01:42<15:42, 26.19s/it]Best trial: 1. Best value: 130.372:  10%|█         | 4/40 [01:42<15:42, 26.19s/it]Best trial: 1. Best value: 130.372:  12%|█▎        | 5/40 [01:42<10:28, 17.96s/it]                                                                                  [I 2025-10-06 09:40:54,640] Trial 11 finished with value: 130.37863279933947 and parameters: {'n1': 512, 'n2': 224, 'do1': 0.4847685553939329, 'do2': 0.4661451709558935, 'lr': 0.0018460840016650518, 'l2': 2.8264113462394305e-05, 'act': 'selu', 'batch': 512, 'epochs': 119}. Best is trial 1 with value: 130.37151691176643.
Best trial: 1. Best value: 130.372:  12%|█▎        | 5/40 [01:53<10:28, 17.96s/it]Best trial: 1. Best value: 130.372:  12%|█▎        | 5/40 [01:53<10:28, 17.96s/it]Best trial: 1. Best value: 130.372:  15%|█▌        | 6/40 [01:53<08:45, 15.47s/it]                                                                                  [I 2025-10-06 09:41:04,660] Trial 12 finished with value: 130.5267049424178 and parameters: {'n1': 512, 'n2': 224, 'do1': 0.47290485998685655, 'do2': 0.4774239217162434, 'lr': 0.0017724741404585244, 'l2': 3.262091689107177e-05, 'act': 'selu', 'batch': 512, 'epochs': 116}. Best is trial 1 with value: 130.37151691176643.
Best trial: 1. Best value: 130.372:  15%|█▌        | 6/40 [02:03<08:45, 15.47s/it]Best trial: 1. Best value: 130.372:  15%|█▌        | 6/40 [02:03<08:45, 15.47s/it]Best trial: 1. Best value: 130.372:  18%|█▊        | 7/40 [02:03<07:31, 13.69s/it]                                                                                  [I 2025-10-06 09:41:15,282] Trial 13 finished with value: 130.57597016440275 and parameters: {'n1': 512, 'n2': 224, 'do1': 0.4620915240135678, 'do2': 0.49838445050542113, 'lr': 0.0016970700181232557, 'l2': 3.50498209146749e-05, 'act': 'selu', 'batch': 512, 'epochs': 119}. Best is trial 1 with value: 130.37151691176643.
Best trial: 1. Best value: 130.372:  18%|█▊        | 7/40 [02:13<07:31, 13.69s/it]Best trial: 1. Best value: 130.372:  18%|█▊        | 7/40 [02:13<07:31, 13.69s/it]Best trial: 1. Best value: 130.372:  20%|██        | 8/40 [02:13<06:46, 12.71s/it]                                                                                  [I 2025-10-06 09:41:32,962] Trial 14 finished with value: 130.8579636117917 and parameters: {'n1': 384, 'n2': 128, 'do1': 0.21088679073511474, 'do2': 0.41293411922682, 'lr': 0.004329738785929869, 'l2': 1.341984420640569e-08, 'act': 'selu', 'batch': 64, 'epochs': 116}. Best is trial 1 with value: 130.37151691176643.
Best trial: 1. Best value: 130.372:  20%|██        | 8/40 [02:31<06:46, 12.71s/it]Best trial: 1. Best value: 130.372:  20%|██        | 8/40 [02:31<06:46, 12.71s/it]Best trial: 1. Best value: 130.372:  22%|██▎       | 9/40 [02:31<07:22, 14.26s/it]                                                                                  [I 2025-10-06 09:41:43,040] Trial 15 finished with value: 130.07119444750248 and parameters: {'n1': 448, 'n2': 192, 'do1': 0.23105737920056402, 'do2': 0.3892166220853729, 'lr': 0.0011808462911388682, 'l2': 3.9315827299907635e-05, 'act': 'gelu', 'batch': 512, 'epochs': 78}. Best is trial 15 with value: 130.07119444750248.
Best trial: 1. Best value: 130.372:  22%|██▎       | 9/40 [02:41<07:22, 14.26s/it]Best trial: 15. Best value: 130.071:  22%|██▎       | 9/40 [02:41<07:22, 14.26s/it]Best trial: 15. Best value: 130.071:  25%|██▌       | 10/40 [02:41<06:29, 12.97s/it]                                                                                    [I 2025-10-06 09:42:07,164] Trial 16 finished with value: 130.27450735130415 and parameters: {'n1': 384, 'n2': 160, 'do1': 0.22829310219846358, 'do2': 0.4049125728568978, 'lr': 0.0009303213441560056, 'l2': 1.0284384093335595e-06, 'act': 'gelu', 'batch': 64, 'epochs': 78}. Best is trial 15 with value: 130.07119444750248.
Best trial: 15. Best value: 130.071:  25%|██▌       | 10/40 [03:05<06:29, 12.97s/it]Best trial: 15. Best value: 130.071:  25%|██▌       | 10/40 [03:05<06:29, 12.97s/it]Best trial: 15. Best value: 130.071:  28%|██▊       | 11/40 [03:05<07:55, 16.38s/it]                                                                                    [I 2025-10-06 09:42:28,656] Trial 17 finished with value: 130.51646956658382 and parameters: {'n1': 384, 'n2': 160, 'do1': 0.2298356408716007, 'do2': 0.39951934417331, 'lr': 0.001172763730946484, 'l2': 1.0028168982127676e-05, 'act': 'gelu', 'batch': 64, 'epochs': 41}. Best is trial 15 with value: 130.07119444750248.
Best trial: 15. Best value: 130.071:  28%|██▊       | 11/40 [03:27<07:55, 16.38s/it]Best trial: 15. Best value: 130.071:  28%|██▊       | 11/40 [03:27<07:55, 16.38s/it]Best trial: 15. Best value: 130.071:  30%|███       | 12/40 [03:27<08:22, 17.94s/it]                                                                                    [I 2025-10-06 09:42:53,300] Trial 18 finished with value: 130.18733497349118 and parameters: {'n1': 448, 'n2': 160, 'do1': 0.28254536530483404, 'do2': 0.3968772960934167, 'lr': 0.0009268844855446789, 'l2': 9.53646058214302e-05, 'act': 'gelu', 'batch': 64, 'epochs': 74}. Best is trial 15 with value: 130.07119444750248.
Best trial: 15. Best value: 130.071:  30%|███       | 12/40 [03:51<08:22, 17.94s/it]Best trial: 15. Best value: 130.071:  30%|███       | 12/40 [03:51<08:22, 17.94s/it]Best trial: 15. Best value: 130.071:  32%|███▎      | 13/40 [03:51<08:59, 19.97s/it]                                                                                    [I 2025-10-06 09:43:04,110] Trial 19 finished with value: 131.18271340719784 and parameters: {'n1': 448, 'n2': 192, 'do1': 0.310829961962555, 'do2': 0.008198863860606476, 'lr': 0.0034652336603720694, 'l2': 0.00013625001376651005, 'act': 'gelu', 'batch': 64, 'epochs': 72}. Best is trial 15 with value: 130.07119444750248.
Best trial: 15. Best value: 130.071:  32%|███▎      | 13/40 [04:02<08:59, 19.97s/it]Best trial: 15. Best value: 130.071:  32%|███▎      | 13/40 [04:02<08:59, 19.97s/it]Best trial: 15. Best value: 130.071:  35%|███▌      | 14/40 [04:02<07:27, 17.20s/it]                                                                                    [I 2025-10-06 09:43:16,063] Trial 20 finished with value: 130.10679957971067 and parameters: {'n1': 448, 'n2': 160, 'do1': 0.40826763400526844, 'do2': 0.3803609155918469, 'lr': 0.0008928729201508562, 'l2': 9.45940839936272e-05, 'act': 'gelu', 'batch': 512, 'epochs': 44}. Best is trial 15 with value: 130.07119444750248.
Best trial: 15. Best value: 130.071:  35%|███▌      | 14/40 [04:14<07:27, 17.20s/it]Best trial: 15. Best value: 130.071:  35%|███▌      | 14/40 [04:14<07:27, 17.20s/it]Best trial: 15. Best value: 130.071:  38%|███▊      | 15/40 [04:14<06:30, 15.62s/it]                                                                                    [I 2025-10-06 09:43:25,138] Trial 21 finished with value: 129.7083642855194 and parameters: {'n1': 448, 'n2': 192, 'do1': 0.40788846054725514, 'do2': 0.35657711633980543, 'lr': 0.002943045606835861, 'l2': 0.00015593203026677776, 'act': 'gelu', 'batch': 512, 'epochs': 41}. Best is trial 21 with value: 129.7083642855194.
Best trial: 15. Best value: 130.071:  38%|███▊      | 15/40 [04:23<06:30, 15.62s/it]Best trial: 21. Best value: 129.708:  38%|███▊      | 15/40 [04:23<06:30, 15.62s/it]Best trial: 21. Best value: 129.708:  40%|████      | 16/40 [04:23<05:27, 13.65s/it]                                                                                    [I 2025-10-06 09:43:34,713] Trial 22 finished with value: 129.73011348083375 and parameters: {'n1': 448, 'n2': 192, 'do1': 0.4072864107188855, 'do2': 0.35073734307890286, 'lr': 0.0025152679446348775, 'l2': 0.00017909590801852682, 'act': 'gelu', 'batch': 512, 'epochs': 40}. Best is trial 21 with value: 129.7083642855194.
Best trial: 21. Best value: 129.708:  40%|████      | 16/40 [04:33<05:27, 13.65s/it]Best trial: 21. Best value: 129.708:  40%|████      | 16/40 [04:33<05:27, 13.65s/it]Best trial: 21. Best value: 129.708:  42%|████▎     | 17/40 [04:33<04:45, 12.42s/it]                                                                                    [I 2025-10-06 09:43:44,055] Trial 23 finished with value: 129.8747518645368 and parameters: {'n1': 448, 'n2': 192, 'do1': 0.4015213766548885, 'do2': 0.3510113145457912, 'lr': 0.0030396440209518273, 'l2': 0.00023472276540727506, 'act': 'gelu', 'batch': 512, 'epochs': 54}. Best is trial 21 with value: 129.7083642855194.
Best trial: 21. Best value: 129.708:  42%|████▎     | 17/40 [04:42<04:45, 12.42s/it]Best trial: 21. Best value: 129.708:  42%|████▎     | 17/40 [04:42<04:45, 12.42s/it]Best trial: 21. Best value: 129.708:  45%|████▌     | 18/40 [04:42<04:12, 11.50s/it]                                                                                    [I 2025-10-06 09:43:52,063] Trial 24 finished with value: 130.16999102135637 and parameters: {'n1': 384, 'n2': 128, 'do1': 0.41167491706788545, 'do2': 0.2108726115100513, 'lr': 0.002852224983296068, 'l2': 0.000977783530336048, 'act': 'gelu', 'batch': 512, 'epochs': 51}. Best is trial 21 with value: 129.7083642855194.
Best trial: 21. Best value: 129.708:  45%|████▌     | 18/40 [04:50<04:12, 11.50s/it]Best trial: 21. Best value: 129.708:  45%|████▌     | 18/40 [04:50<04:12, 11.50s/it]Best trial: 21. Best value: 129.708:  48%|████▊     | 19/40 [04:50<03:39, 10.45s/it]                                                                                    [I 2025-10-06 09:43:59,710] Trial 25 finished with value: 129.9693774029098 and parameters: {'n1': 256, 'n2': 128, 'do1': 0.42595421601238204, 'do2': 0.3501191485755071, 'lr': 0.0025698478297002357, 'l2': 0.000244804790439247, 'act': 'gelu', 'batch': 512, 'epochs': 55}. Best is trial 21 with value: 129.7083642855194.
Best trial: 21. Best value: 129.708:  48%|████▊     | 19/40 [04:58<03:39, 10.45s/it]Best trial: 21. Best value: 129.708:  48%|████▊     | 19/40 [04:58<03:39, 10.45s/it]Best trial: 21. Best value: 129.708:  50%|█████     | 20/40 [04:58<03:12,  9.61s/it]                                                                                    [I 2025-10-06 09:44:10,470] Trial 26 finished with value: 129.9924351765325 and parameters: {'n1': 512, 'n2': 256, 'do1': 0.3552148184511737, 'do2': 0.44358493834571333, 'lr': 0.004227590966211708, 'l2': 0.000237690844169047, 'act': 'gelu', 'batch': 512, 'epochs': 52}. Best is trial 21 with value: 129.7083642855194.
Best trial: 21. Best value: 129.708:  50%|█████     | 20/40 [05:09<03:12,  9.61s/it]Best trial: 21. Best value: 129.708:  50%|█████     | 20/40 [05:09<03:12,  9.61s/it]Best trial: 21. Best value: 129.708:  52%|█████▎    | 21/40 [05:09<03:09,  9.95s/it]                                                                                    [I 2025-10-06 09:44:19,869] Trial 27 finished with value: 129.74044100144718 and parameters: {'n1': 320, 'n2': 128, 'do1': 0.44481676287841676, 'do2': 0.21884835485945495, 'lr': 0.0022906271278912986, 'l2': 9.521062038625787e-06, 'act': 'gelu', 'batch': 512, 'epochs': 41}. Best is trial 21 with value: 129.7083642855194.
Best trial: 21. Best value: 129.708:  52%|█████▎    | 21/40 [05:18<03:09,  9.95s/it]Best trial: 21. Best value: 129.708:  52%|█████▎    | 21/40 [05:18<03:09,  9.95s/it]Best trial: 21. Best value: 129.708:  55%|█████▌    | 22/40 [05:18<02:56,  9.79s/it]                                                                                    [I 2025-10-06 09:44:28,684] Trial 28 finished with value: 129.93756764067504 and parameters: {'n1': 320, 'n2': 128, 'do1': 0.435205423974946, 'do2': 0.208525818851532, 'lr': 0.0022319720276003725, 'l2': 1.2505311737536462e-05, 'act': 'gelu', 'batch': 512, 'epochs': 41}. Best is trial 21 with value: 129.7083642855194.
Best trial: 21. Best value: 129.708:  55%|█████▌    | 22/40 [05:27<02:56,  9.79s/it]Best trial: 21. Best value: 129.708:  55%|█████▌    | 22/40 [05:27<02:56,  9.79s/it]Best trial: 21. Best value: 129.708:  57%|█████▊    | 23/40 [05:27<02:41,  9.50s/it]                                                                                    [I 2025-10-06 09:44:31,963] Trial 29 pruned. Trial was pruned at epoch 5.
Best trial: 21. Best value: 129.708:  57%|█████▊    | 23/40 [05:30<02:41,  9.50s/it]Best trial: 21. Best value: 129.708:  57%|█████▊    | 23/40 [05:30<02:41,  9.50s/it]Best trial: 21. Best value: 129.708:  60%|██████    | 24/40 [05:30<02:02,  7.63s/it]                                                                                    [I 2025-10-06 09:44:40,959] Trial 30 finished with value: 129.78481288752548 and parameters: {'n1': 384, 'n2': 160, 'do1': 0.3777784645200089, 'do2': 0.30088496175063717, 'lr': 0.004812703043521337, 'l2': 1.4883924743643942e-05, 'act': 'gelu', 'batch': 512, 'epochs': 62}. Best is trial 21 with value: 129.7083642855194.
Best trial: 21. Best value: 129.708:  60%|██████    | 24/40 [05:39<02:02,  7.63s/it]Best trial: 21. Best value: 129.708:  60%|██████    | 24/40 [05:39<02:02,  7.63s/it]Best trial: 21. Best value: 129.708:  62%|██████▎   | 25/40 [05:39<02:00,  8.04s/it]                                                                                    [I 2025-10-06 09:44:48,087] Trial 31 finished with value: 129.9957030539856 and parameters: {'n1': 256, 'n2': 64, 'do1': 0.34161378584919894, 'do2': 0.292357878596846, 'lr': 0.0035394631561635097, 'l2': 5.8145426031110536e-05, 'act': 'gelu', 'batch': 512, 'epochs': 46}. Best is trial 21 with value: 129.7083642855194.
Best trial: 21. Best value: 129.708:  62%|██████▎   | 25/40 [05:46<02:00,  8.04s/it]Best trial: 21. Best value: 129.708:  62%|██████▎   | 25/40 [05:46<02:00,  8.04s/it]Best trial: 21. Best value: 129.708:  65%|██████▌   | 26/40 [05:46<01:48,  7.77s/it]                                                                                    [I 2025-10-06 09:44:56,114] Trial 32 finished with value: 129.6991561026902 and parameters: {'n1': 384, 'n2': 160, 'do1': 0.37294085185940923, 'do2': 0.29172869700977455, 'lr': 0.004763717990181229, 'l2': 7.275111101829076e-06, 'act': 'gelu', 'batch': 512, 'epochs': 64}. Best is trial 32 with value: 129.6991561026902.
Best trial: 21. Best value: 129.708:  65%|██████▌   | 26/40 [05:54<01:48,  7.77s/it]Best trial: 32. Best value: 129.699:  65%|██████▌   | 26/40 [05:54<01:48,  7.77s/it]Best trial: 32. Best value: 129.699:  68%|██████▊   | 27/40 [05:54<01:41,  7.84s/it]                                                                                    [I 2025-10-06 09:45:05,317] Trial 33 finished with value: 129.9111775887664 and parameters: {'n1': 320, 'n2': 128, 'do1': 0.448742883390127, 'do2': 0.18257860783103713, 'lr': 0.002144615818207625, 'l2': 6.810974329344077e-06, 'act': 'gelu', 'batch': 512, 'epochs': 40}. Best is trial 32 with value: 129.6991561026902.
Best trial: 32. Best value: 129.699:  68%|██████▊   | 27/40 [06:03<01:41,  7.84s/it]Best trial: 32. Best value: 129.699:  68%|██████▊   | 27/40 [06:03<01:41,  7.84s/it]Best trial: 32. Best value: 129.699:  70%|███████   | 28/40 [06:03<01:39,  8.25s/it]                                                                                    [I 2025-10-06 09:45:15,927] Trial 34 finished with value: 129.90989966607626 and parameters: {'n1': 384, 'n2': 160, 'do1': 0.38536856409222636, 'do2': 0.27519405094006366, 'lr': 0.0035519802736144477, 'l2': 1.071253535826957e-06, 'act': 'gelu', 'batch': 512, 'epochs': 68}. Best is trial 32 with value: 129.6991561026902.
Best trial: 32. Best value: 129.699:  70%|███████   | 28/40 [06:14<01:39,  8.25s/it]Best trial: 32. Best value: 129.699:  70%|███████   | 28/40 [06:14<01:39,  8.25s/it]Best trial: 32. Best value: 129.699:  72%|███████▎  | 29/40 [06:14<01:38,  8.96s/it]                                                                                    [I 2025-10-06 09:45:23,443] Trial 35 finished with value: 129.96126977151692 and parameters: {'n1': 448, 'n2': 192, 'do1': 0.33712435689658354, 'do2': 0.24298096306322461, 'lr': 0.0023860795833066844, 'l2': 1.7469193055629813e-05, 'act': 'gelu', 'batch': 512, 'epochs': 87}. Best is trial 32 with value: 129.6991561026902.
Best trial: 32. Best value: 129.699:  72%|███████▎  | 29/40 [06:22<01:38,  8.96s/it]Best trial: 32. Best value: 129.699:  72%|███████▎  | 29/40 [06:22<01:38,  8.96s/it]Best trial: 32. Best value: 129.699:  75%|███████▌  | 30/40 [06:22<01:25,  8.53s/it]                                                                                    [I 2025-10-06 09:45:32,421] Trial 36 finished with value: 130.0000751201706 and parameters: {'n1': 320, 'n2': 128, 'do1': 0.44442784772843197, 'do2': 0.3298196651297162, 'lr': 0.004768126836731413, 'l2': 3.1815334925087537e-06, 'act': 'gelu', 'batch': 512, 'epochs': 49}. Best is trial 32 with value: 129.6991561026902.
Best trial: 32. Best value: 129.699:  75%|███████▌  | 30/40 [06:31<01:25,  8.53s/it]Best trial: 32. Best value: 129.699:  75%|███████▌  | 30/40 [06:31<01:25,  8.53s/it]Best trial: 32. Best value: 129.699:  78%|███████▊  | 31/40 [06:31<01:17,  8.66s/it]                                                                                    [I 2025-10-06 09:45:45,116] Trial 37 finished with value: 130.14070660490898 and parameters: {'n1': 384, 'n2': 160, 'do1': 0.38452061957725425, 'do2': 0.1132863750815153, 'lr': 0.0014465691936696502, 'l2': 0.00045135497521755575, 'act': 'gelu', 'batch': 128, 'epochs': 59}. Best is trial 32 with value: 129.6991561026902.
Best trial: 32. Best value: 129.699:  78%|███████▊  | 31/40 [06:43<01:17,  8.66s/it]Best trial: 32. Best value: 129.699:  78%|███████▊  | 31/40 [06:43<01:17,  8.66s/it]Best trial: 32. Best value: 129.699:  80%|████████  | 32/40 [06:43<01:18,  9.87s/it]2025-10-06 09:45:47.188075: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_48', 264 bytes spill stores, 264 bytes spill loads

2025-10-06 09:45:47.406588: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_48', 1888 bytes spill stores, 1636 bytes spill loads

2025-10-06 09:45:47.760667: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_48', 12 bytes spill stores, 12 bytes spill loads

2025-10-06 09:45:47.835012: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_48', 268 bytes spill stores, 268 bytes spill loads

2025-10-06 09:45:48.059267: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_48', 1240 bytes spill stores, 1036 bytes spill loads

                                                                                    [I 2025-10-06 09:45:49,324] Trial 38 pruned. Trial was pruned at epoch 5.
Best trial: 32. Best value: 129.699:  80%|████████  | 32/40 [06:47<01:18,  9.87s/it]Best trial: 32. Best value: 129.699:  80%|████████  | 32/40 [06:47<01:18,  9.87s/it]Best trial: 32. Best value: 129.699:  82%|████████▎ | 33/40 [06:47<00:57,  8.17s/it]                                                                                    [I 2025-10-06 09:45:59,987] Trial 39 finished with value: 129.83400610250382 and parameters: {'n1': 448, 'n2': 192, 'do1': 0.28071428880717153, 'do2': 0.30800413786498493, 'lr': 0.002030757687346674, 'l2': 1.7621278369079448e-06, 'act': 'gelu', 'batch': 256, 'epochs': 58}. Best is trial 32 with value: 129.6991561026902.
Best trial: 32. Best value: 129.699:  82%|████████▎ | 33/40 [06:58<00:57,  8.17s/it]Best trial: 32. Best value: 129.699:  82%|████████▎ | 33/40 [06:58<00:57,  8.17s/it]Best trial: 32. Best value: 129.699:  85%|████████▌ | 34/40 [06:58<00:53,  8.92s/it]2025-10-06 09:46:02.140201: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_48', 24 bytes spill stores, 24 bytes spill loads

2025-10-06 09:46:02.298886: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_48_0', 776 bytes spill stores, 724 bytes spill loads

2025-10-06 09:46:02.364078: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_48', 928 bytes spill stores, 884 bytes spill loads

2025-10-06 09:46:02.367350: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_48', 1032 bytes spill stores, 1012 bytes spill loads

2025-10-06 09:46:02.814225: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_48', 48 bytes spill stores, 48 bytes spill loads

2025-10-06 09:46:02.977411: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_48_0', 1044 bytes spill stores, 732 bytes spill loads

2025-10-06 09:46:03.067573: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_48', 996 bytes spill stores, 852 bytes spill loads

2025-10-06 09:46:03.091328: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_48', 1148 bytes spill stores, 948 bytes spill loads

                                                                                    [I 2025-10-06 09:46:05,024] Trial 40 pruned. Trial was pruned at epoch 5.
Best trial: 32. Best value: 129.699:  85%|████████▌ | 34/40 [07:03<00:53,  8.92s/it]Best trial: 32. Best value: 129.699:  85%|████████▌ | 34/40 [07:03<00:53,  8.92s/it]Best trial: 32. Best value: 129.699:  88%|████████▊ | 35/40 [07:03<00:38,  7.75s/it]                                                                                    [I 2025-10-06 09:46:07,836] Trial 41 pruned. Trial was pruned at epoch 5.
Best trial: 32. Best value: 129.699:  88%|████████▊ | 35/40 [07:06<00:38,  7.75s/it]Best trial: 32. Best value: 129.699:  88%|████████▊ | 35/40 [07:06<00:38,  7.75s/it]Best trial: 32. Best value: 129.699:  90%|█████████ | 36/40 [07:06<00:25,  6.27s/it]                                                                                    [I 2025-10-06 09:46:11,056] Trial 42 pruned. Trial was pruned at epoch 5.
Best trial: 32. Best value: 129.699:  90%|█████████ | 36/40 [07:09<00:25,  6.27s/it]Best trial: 32. Best value: 129.699:  90%|█████████ | 36/40 [07:09<00:25,  6.27s/it]Best trial: 32. Best value: 129.699:  92%|█████████▎| 37/40 [07:09<00:16,  5.36s/it]                                                                                    [I 2025-10-06 09:46:22,277] Trial 43 finished with value: 129.81802166879604 and parameters: {'n1': 384, 'n2': 160, 'do1': 0.4703597814896421, 'do2': 0.329151844439126, 'lr': 0.0028929435034253737, 'l2': 6.330410746237509e-06, 'act': 'gelu', 'batch': 512, 'epochs': 55}. Best is trial 32 with value: 129.6991561026902.
Best trial: 32. Best value: 129.699:  92%|█████████▎| 37/40 [07:20<00:16,  5.36s/it]Best trial: 32. Best value: 129.699:  92%|█████████▎| 37/40 [07:20<00:16,  5.36s/it]Best trial: 32. Best value: 129.699:  95%|█████████▌| 38/40 [07:20<00:14,  7.12s/it]                                                                                    [I 2025-10-06 09:46:31,695] Trial 44 finished with value: 129.7948351004384 and parameters: {'n1': 320, 'n2': 128, 'do1': 0.39372309062127975, 'do2': 0.2587210013356572, 'lr': 0.0040141093038205565, 'l2': 5.859484746084697e-05, 'act': 'gelu', 'batch': 512, 'epochs': 88}. Best is trial 32 with value: 129.6991561026902.
Best trial: 32. Best value: 129.699:  95%|█████████▌| 38/40 [07:30<00:14,  7.12s/it]Best trial: 32. Best value: 129.699:  95%|█████████▌| 38/40 [07:30<00:14,  7.12s/it]Best trial: 32. Best value: 129.699:  98%|█████████▊| 39/40 [07:30<00:07,  7.81s/it]                                                                                    [I 2025-10-06 09:46:39,765] Trial 45 pruned. Trial was pruned at epoch 15.
Best trial: 32. Best value: 129.699:  98%|█████████▊| 39/40 [07:38<00:07,  7.81s/it]Best trial: 32. Best value: 129.699:  98%|█████████▊| 39/40 [07:38<00:07,  7.81s/it]Best trial: 32. Best value: 129.699: 100%|██████████| 40/40 [07:38<00:00,  7.89s/it]Best trial: 32. Best value: 129.699: 100%|██████████| 40/40 [07:38<00:00, 11.46s/it]
/home/e.ladino/miniconda3/envs/e_ladino/lib/python3.12/site-packages/keras/src/saving/saving_lib.py:797: UserWarning: Skipping variable loading for optimizer 'adam', because it has 2 variables whereas the saved optimizer has 14 variables. 
  saveable.load_own_variables(weights_store.get(inner_path))
Best MLP params: {'n1': 384, 'n2': 160, 'do1': 0.37294085185940923, 'do2': 0.29172869700977455, 'lr': 0.004763717990181229, 'l2': 7.275111101829076e-06, 'act': 'gelu', 'batch': 512, 'epochs': 64}
MLP test → RMSE: 135.5935 | MAE: 66.8857 | R2: 0.7228 | Skill: 0.309
/mnt/SOLARLAB/E_Ladino/Repo/irradiance-fusion-forecast/Notebooks/05_ground_hpo_optuna_v1.py:141: FutureWarning: The import path :class:`~optuna.storages.JournalFileOpenLock` has been deprecated in v4.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v4.0.0. Use :class:`~optuna.storages.journal.JournalFileOpenLock` instead.
  file_storage = JournalFileStorage(str(log_path), lock_obj=JournalFileOpenLock(str(lock_path)))
/mnt/SOLARLAB/E_Ladino/Repo/irradiance-fusion-forecast/Notebooks/05_ground_hpo_optuna_v1.py:141: FutureWarning: JournalFileStorage has been deprecated in v4.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v4.0.0. Use :class:`~optuna.storages.journal.JournalFileBackend` instead.
  file_storage = JournalFileStorage(str(log_path), lock_obj=JournalFileOpenLock(str(lock_path)))
[I 2025-10-06 09:46:40,105] A new study created in Journal with name: ground_trackB_lstm
Running Study B1 (LSTM)…
  0%|          | 0/40 [00:00<?, ?it/s]                                      [I 2025-10-06 09:47:34,118] Trial 0 finished with value: 256.02015606686126 and parameters: {'seq_len': 12, 'units': 32, 'dropout': 0.062397808134481064, 'lr': 6.533369619026643e-05, 'batch': 64, 'epochs': 41}. Best is trial 0 with value: 256.02015606686126.
  0%|          | 0/40 [00:54<?, ?it/s]Best trial: 0. Best value: 256.02:   0%|          | 0/40 [00:54<?, ?it/s]Best trial: 0. Best value: 256.02:   2%|▎         | 1/40 [00:54<35:06, 54.01s/it]                                                                                 [I 2025-10-06 09:47:54,691] Trial 1 finished with value: 203.21497045924053 and parameters: {'seq_len': 6, 'units': 32, 'dropout': 0.1216968971838151, 'lr': 0.0005603803105930283, 'batch': 256, 'epochs': 51}. Best is trial 1 with value: 203.21497045924053.
Best trial: 0. Best value: 256.02:   2%|▎         | 1/40 [01:14<35:06, 54.01s/it]Best trial: 1. Best value: 203.215:   2%|▎         | 1/40 [01:14<35:06, 54.01s/it]Best trial: 1. Best value: 203.215:   5%|▌         | 2/40 [01:14<21:45, 34.34s/it]                                                                                  [I 2025-10-06 09:48:31,219] Trial 2 finished with value: 145.4438116378624 and parameters: {'seq_len': 24, 'units': 32, 'dropout': 0.20569377536544464, 'lr': 0.000765242606091573, 'batch': 128, 'epochs': 45}. Best is trial 2 with value: 145.4438116378624.
Best trial: 1. Best value: 203.215:   5%|▌         | 2/40 [01:51<21:45, 34.34s/it]Best trial: 2. Best value: 145.444:   5%|▌         | 2/40 [01:51<21:45, 34.34s/it]Best trial: 2. Best value: 145.444:   8%|▊         | 3/40 [01:51<21:47, 35.34s/it]                                                                                  [I 2025-10-06 09:49:51,511] Trial 3 finished with value: 135.90947987079488 and parameters: {'seq_len': 12, 'units': 32, 'dropout': 0.2736932106048628, 'lr': 0.0003795552402641347, 'batch': 128, 'epochs': 113}. Best is trial 3 with value: 135.90947987079488.
Best trial: 2. Best value: 145.444:   8%|▊         | 3/40 [03:11<21:47, 35.34s/it]Best trial: 3. Best value: 135.909:   8%|▊         | 3/40 [03:11<21:47, 35.34s/it]Best trial: 3. Best value: 135.909:  10%|█         | 4/40 [03:11<31:51, 53.09s/it]                                                                                  [I 2025-10-06 09:50:12,946] Trial 4 finished with value: 132.2333918565012 and parameters: {'seq_len': 12, 'units': 96, 'dropout': 0.07394178221021082, 'lr': 0.004346495755569775, 'batch': 128, 'epochs': 88}. Best is trial 4 with value: 132.2333918565012.
Best trial: 3. Best value: 135.909:  10%|█         | 4/40 [03:32<31:51, 53.09s/it]Best trial: 4. Best value: 132.233:  10%|█         | 4/40 [03:32<31:51, 53.09s/it]Best trial: 4. Best value: 132.233:  12%|█▎        | 5/40 [03:32<24:18, 41.67s/it]                                                                                  [I 2025-10-06 09:52:07,113] Trial 5 finished with value: 133.77372745143197 and parameters: {'seq_len': 6, 'units': 64, 'dropout': 0.15547091587579281, 'lr': 0.0001744488327445185, 'batch': 64, 'epochs': 83}. Best is trial 4 with value: 132.2333918565012.
Best trial: 4. Best value: 132.233:  12%|█▎        | 5/40 [05:27<24:18, 41.67s/it]Best trial: 4. Best value: 132.233:  12%|█▎        | 5/40 [05:27<24:18, 41.67s/it]Best trial: 4. Best value: 132.233:  15%|█▌        | 6/40 [05:27<37:34, 66.32s/it]                                                                                  [I 2025-10-06 09:54:44,119] Trial 6 finished with value: 141.4069233409383 and parameters: {'seq_len': 24, 'units': 128, 'dropout': 0.07948627261366897, 'lr': 5.12878198709283e-05, 'batch': 64, 'epochs': 102}. Best is trial 4 with value: 132.2333918565012.
Best trial: 4. Best value: 132.233:  15%|█▌        | 6/40 [08:04<37:34, 66.32s/it]Best trial: 4. Best value: 132.233:  15%|█▌        | 6/40 [08:04<37:34, 66.32s/it]Best trial: 4. Best value: 132.233:  18%|█▊        | 7/40 [08:04<52:46, 95.97s/it]                                                                                  [I 2025-10-06 09:55:32,496] Trial 7 finished with value: 229.91241538899112 and parameters: {'seq_len': 24, 'units': 96, 'dropout': 0.13235920994105968, 'lr': 6.700183621677408e-05, 'batch': 256, 'epochs': 91}. Best is trial 4 with value: 132.2333918565012.
Best trial: 4. Best value: 132.233:  18%|█▊        | 7/40 [08:52<52:46, 95.97s/it]Best trial: 4. Best value: 132.233:  18%|█▊        | 7/40 [08:52<52:46, 95.97s/it]Best trial: 4. Best value: 132.233:  20%|██        | 8/40 [08:52<43:06, 80.82s/it]                                                                                  [I 2025-10-06 09:55:52,822] Trial 8 finished with value: 131.35028906515583 and parameters: {'seq_len': 6, 'units': 128, 'dropout': 0.2245108790277985, 'lr': 0.0017414233532634423, 'batch': 128, 'epochs': 42}. Best is trial 8 with value: 131.35028906515583.
Best trial: 4. Best value: 132.233:  20%|██        | 8/40 [09:12<43:06, 80.82s/it]Best trial: 8. Best value: 131.35:  20%|██        | 8/40 [09:12<43:06, 80.82s/it] Best trial: 8. Best value: 131.35:  22%|██▎       | 9/40 [09:12<31:59, 61.91s/it]                                                                                 [I 2025-10-06 09:56:30,283] Trial 9 finished with value: 173.4148295994319 and parameters: {'seq_len': 18, 'units': 96, 'dropout': 0.3630265895704372, 'lr': 0.00015759936475969445, 'batch': 128, 'epochs': 46}. Best is trial 8 with value: 131.35028906515583.
Best trial: 8. Best value: 131.35:  22%|██▎       | 9/40 [09:50<31:59, 61.91s/it]Best trial: 8. Best value: 131.35:  22%|██▎       | 9/40 [09:50<31:59, 61.91s/it]Best trial: 8. Best value: 131.35:  25%|██▌       | 10/40 [09:50<27:10, 54.36s/it]                                                                                  [I 2025-10-06 09:56:47,596] Trial 10 finished with value: 131.4275733293817 and parameters: {'seq_len': 6, 'units': 128, 'dropout': 0.2784471213433284, 'lr': 0.0027539578176416475, 'batch': 128, 'epochs': 65}. Best is trial 8 with value: 131.35028906515583.
Best trial: 8. Best value: 131.35:  25%|██▌       | 10/40 [10:07<27:10, 54.36s/it]Best trial: 8. Best value: 131.35:  25%|██▌       | 10/40 [10:07<27:10, 54.36s/it]Best trial: 8. Best value: 131.35:  28%|██▊       | 11/40 [10:07<20:47, 43.02s/it]                                                                                  [I 2025-10-06 09:57:03,860] Trial 11 finished with value: 130.55079381461073 and parameters: {'seq_len': 6, 'units': 128, 'dropout': 0.28709113645897344, 'lr': 0.003525724975766174, 'batch': 128, 'epochs': 64}. Best is trial 11 with value: 130.55079381461073.
Best trial: 8. Best value: 131.35:  28%|██▊       | 11/40 [10:23<20:47, 43.02s/it]Best trial: 11. Best value: 130.551:  28%|██▊       | 11/40 [10:23<20:47, 43.02s/it]Best trial: 11. Best value: 130.551:  30%|███       | 12/40 [10:23<16:16, 34.88s/it]                                                                                    [I 2025-10-06 09:57:24,961] Trial 12 finished with value: 131.16734748737966 and parameters: {'seq_len': 6, 'units': 128, 'dropout': 0.24394214564709016, 'lr': 0.001615337308674967, 'batch': 128, 'epochs': 65}. Best is trial 11 with value: 130.55079381461073.
Best trial: 11. Best value: 130.551:  30%|███       | 12/40 [10:44<16:16, 34.88s/it]Best trial: 11. Best value: 130.551:  30%|███       | 12/40 [10:44<16:16, 34.88s/it]Best trial: 11. Best value: 130.551:  32%|███▎      | 13/40 [10:44<13:49, 30.71s/it]                                                                                    [I 2025-10-06 09:57:45,610] Trial 13 finished with value: 133.1774104578175 and parameters: {'seq_len': 6, 'units': 128, 'dropout': 0.38146553658251803, 'lr': 0.0011968595971406895, 'batch': 128, 'epochs': 67}. Best is trial 11 with value: 130.55079381461073.
Best trial: 11. Best value: 130.551:  32%|███▎      | 13/40 [11:05<13:49, 30.71s/it]Best trial: 11. Best value: 130.551:  32%|███▎      | 13/40 [11:05<13:49, 30.71s/it]Best trial: 11. Best value: 130.551:  35%|███▌      | 14/40 [11:05<11:59, 27.67s/it]                                                                                    [I 2025-10-06 09:58:14,711] Trial 14 finished with value: 130.5315754424959 and parameters: {'seq_len': 18, 'units': 64, 'dropout': 0.30877183350407733, 'lr': 0.004909113439094563, 'batch': 128, 'epochs': 67}. Best is trial 14 with value: 130.5315754424959.
Best trial: 11. Best value: 130.551:  35%|███▌      | 14/40 [11:34<11:59, 27.67s/it]Best trial: 14. Best value: 130.532:  35%|███▌      | 14/40 [11:34<11:59, 27.67s/it]Best trial: 14. Best value: 130.532:  38%|███▊      | 15/40 [11:34<11:42, 28.10s/it]                                                                                    [I 2025-10-06 09:58:38,623] Trial 15 finished with value: 130.91237079865675 and parameters: {'seq_len': 18, 'units': 64, 'dropout': 0.3259134876019591, 'lr': 0.00491961297296634, 'batch': 256, 'epochs': 72}. Best is trial 14 with value: 130.5315754424959.
Best trial: 14. Best value: 130.532:  38%|███▊      | 15/40 [11:58<11:42, 28.10s/it]Best trial: 14. Best value: 130.532:  38%|███▊      | 15/40 [11:58<11:42, 28.10s/it]Best trial: 14. Best value: 130.532:  40%|████      | 16/40 [11:58<10:44, 26.84s/it]                                                                                    [I 2025-10-06 09:59:10,612] Trial 16 finished with value: 130.54563228762194 and parameters: {'seq_len': 18, 'units': 64, 'dropout': 0.3182781881526315, 'lr': 0.0027912393303472192, 'batch': 128, 'epochs': 56}. Best is trial 14 with value: 130.5315754424959.
Best trial: 14. Best value: 130.532:  40%|████      | 16/40 [12:30<10:44, 26.84s/it]Best trial: 14. Best value: 130.532:  40%|████      | 16/40 [12:30<10:44, 26.84s/it]Best trial: 14. Best value: 130.532:  42%|████▎     | 17/40 [12:30<10:52, 28.39s/it]                                                                                    [I 2025-10-06 09:59:41,683] Trial 17 finished with value: 130.45266742194275 and parameters: {'seq_len': 18, 'units': 64, 'dropout': 0.32818890127467676, 'lr': 0.0024822021217329212, 'batch': 128, 'epochs': 55}. Best is trial 17 with value: 130.45266742194275.
Best trial: 14. Best value: 130.532:  42%|████▎     | 17/40 [13:01<10:52, 28.39s/it]Best trial: 17. Best value: 130.453:  42%|████▎     | 17/40 [13:01<10:52, 28.39s/it]Best trial: 17. Best value: 130.453:  45%|████▌     | 18/40 [13:01<10:42, 29.19s/it]                                                                                    [I 2025-10-06 10:00:25,970] Trial 18 finished with value: 131.18875058956084 and parameters: {'seq_len': 18, 'units': 64, 'dropout': 0.3930744627111219, 'lr': 0.0017872583251968208, 'batch': 64, 'epochs': 76}. Best is trial 17 with value: 130.45266742194275.
Best trial: 17. Best value: 130.453:  45%|████▌     | 18/40 [13:45<10:42, 29.19s/it]Best trial: 17. Best value: 130.453:  45%|████▌     | 18/40 [13:45<10:42, 29.19s/it]Best trial: 17. Best value: 130.453:  48%|████▊     | 19/40 [13:45<11:48, 33.73s/it]                                                                                    [I 2025-10-06 10:00:30,116] Trial 19 pruned. Trial was pruned at epoch 5.
Best trial: 17. Best value: 130.453:  48%|████▊     | 19/40 [13:50<11:48, 33.73s/it]Best trial: 17. Best value: 130.453:  48%|████▊     | 19/40 [13:50<11:48, 33.73s/it]Best trial: 17. Best value: 130.453:  50%|█████     | 20/40 [13:50<08:16, 24.85s/it]                                                                                    [I 2025-10-06 10:00:35,933] Trial 20 pruned. Trial was pruned at epoch 5.
Best trial: 17. Best value: 130.453:  50%|█████     | 20/40 [13:55<08:16, 24.85s/it]Best trial: 17. Best value: 130.453:  50%|█████     | 20/40 [13:55<08:16, 24.85s/it]Best trial: 17. Best value: 130.453:  52%|█████▎    | 21/40 [13:55<06:03, 19.13s/it]                                                                                    [I 2025-10-06 10:01:16,669] Trial 21 finished with value: 130.1381627588541 and parameters: {'seq_len': 18, 'units': 64, 'dropout': 0.3183509774407929, 'lr': 0.002980651144741477, 'batch': 128, 'epochs': 56}. Best is trial 21 with value: 130.1381627588541.
Best trial: 17. Best value: 130.453:  52%|█████▎    | 21/40 [14:36<06:03, 19.13s/it]Best trial: 21. Best value: 130.138:  52%|█████▎    | 21/40 [14:36<06:03, 19.13s/it]Best trial: 21. Best value: 130.138:  55%|█████▌    | 22/40 [14:36<07:41, 25.62s/it]                                                                                    [I 2025-10-06 10:01:39,638] Trial 22 finished with value: 130.8151651066305 and parameters: {'seq_len': 18, 'units': 64, 'dropout': 0.35297136676504126, 'lr': 0.0025375844352066718, 'batch': 128, 'epochs': 58}. Best is trial 21 with value: 130.1381627588541.
Best trial: 21. Best value: 130.138:  55%|█████▌    | 22/40 [14:59<07:41, 25.62s/it]Best trial: 21. Best value: 130.138:  55%|█████▌    | 22/40 [14:59<07:41, 25.62s/it]Best trial: 21. Best value: 130.138:  57%|█████▊    | 23/40 [14:59<07:01, 24.82s/it]                                                                                    [I 2025-10-06 10:02:04,645] Trial 23 finished with value: 130.36893262487808 and parameters: {'seq_len': 18, 'units': 64, 'dropout': 0.30991216258996757, 'lr': 0.00486118768414028, 'batch': 128, 'epochs': 74}. Best is trial 21 with value: 130.1381627588541.
Best trial: 21. Best value: 130.138:  57%|█████▊    | 23/40 [15:24<07:01, 24.82s/it]Best trial: 21. Best value: 130.138:  57%|█████▊    | 23/40 [15:24<07:01, 24.82s/it]Best trial: 21. Best value: 130.138:  60%|██████    | 24/40 [15:24<06:38, 24.88s/it]                                                                                    [I 2025-10-06 10:02:10,367] Trial 24 pruned. Trial was pruned at epoch 5.
Best trial: 21. Best value: 130.138:  60%|██████    | 24/40 [15:30<06:38, 24.88s/it]Best trial: 21. Best value: 130.138:  60%|██████    | 24/40 [15:30<06:38, 24.88s/it]Best trial: 21. Best value: 130.138:  62%|██████▎   | 25/40 [15:30<04:46, 19.13s/it]                                                                                    [I 2025-10-06 10:02:16,165] Trial 25 pruned. Trial was pruned at epoch 5.
Best trial: 21. Best value: 130.138:  62%|██████▎   | 25/40 [15:36<04:46, 19.13s/it]Best trial: 21. Best value: 130.138:  62%|██████▎   | 25/40 [15:36<04:46, 19.13s/it]Best trial: 21. Best value: 130.138:  65%|██████▌   | 26/40 [15:36<03:31, 15.13s/it]                                                                                    [I 2025-10-06 10:02:21,659] Trial 26 pruned. Trial was pruned at epoch 5.
Best trial: 21. Best value: 130.138:  65%|██████▌   | 26/40 [15:41<03:31, 15.13s/it]Best trial: 21. Best value: 130.138:  65%|██████▌   | 26/40 [15:41<03:31, 15.13s/it]Best trial: 21. Best value: 130.138:  68%|██████▊   | 27/40 [15:41<02:39, 12.24s/it]                                                                                    [I 2025-10-06 10:02:27,251] Trial 27 pruned. Trial was pruned at epoch 5.
Best trial: 21. Best value: 130.138:  68%|██████▊   | 27/40 [15:47<02:39, 12.24s/it]Best trial: 21. Best value: 130.138:  68%|██████▊   | 27/40 [15:47<02:39, 12.24s/it]Best trial: 21. Best value: 130.138:  70%|███████   | 28/40 [15:47<02:02, 10.24s/it]                                                                                    [I 2025-10-06 10:02:31,267] Trial 28 pruned. Trial was pruned at epoch 5.
Best trial: 21. Best value: 130.138:  70%|███████   | 28/40 [15:51<02:02, 10.24s/it]Best trial: 21. Best value: 130.138:  70%|███████   | 28/40 [15:51<02:02, 10.24s/it]Best trial: 21. Best value: 130.138:  72%|███████▎  | 29/40 [15:51<01:32,  8.38s/it]                                                                                    [I 2025-10-06 10:02:51,332] Trial 29 pruned. Trial was pruned at epoch 14.
Best trial: 21. Best value: 130.138:  72%|███████▎  | 29/40 [16:11<01:32,  8.38s/it]Best trial: 21. Best value: 130.138:  72%|███████▎  | 29/40 [16:11<01:32,  8.38s/it]Best trial: 21. Best value: 130.138:  75%|███████▌  | 30/40 [16:11<01:58, 11.88s/it]                                                                                    [I 2025-10-06 10:03:00,927] Trial 30 pruned. Trial was pruned at epoch 5.
Best trial: 21. Best value: 130.138:  75%|███████▌  | 30/40 [16:20<01:58, 11.88s/it]Best trial: 21. Best value: 130.138:  75%|███████▌  | 30/40 [16:20<01:58, 11.88s/it]Best trial: 21. Best value: 130.138:  78%|███████▊  | 31/40 [16:20<01:40, 11.20s/it]                                                                                    [I 2025-10-06 10:03:27,121] Trial 31 finished with value: 131.25481389981474 and parameters: {'seq_len': 18, 'units': 64, 'dropout': 0.31089126385303223, 'lr': 0.004930822412106053, 'batch': 128, 'epochs': 68}. Best is trial 21 with value: 130.1381627588541.
Best trial: 21. Best value: 130.138:  78%|███████▊  | 31/40 [16:47<01:40, 11.20s/it]Best trial: 21. Best value: 130.138:  78%|███████▊  | 31/40 [16:47<01:40, 11.20s/it]Best trial: 21. Best value: 130.138:  80%|████████  | 32/40 [16:47<02:05, 15.70s/it]                                                                                    [I 2025-10-06 10:03:57,640] Trial 32 finished with value: 130.72769587486042 and parameters: {'seq_len': 18, 'units': 64, 'dropout': 0.3083424310367533, 'lr': 0.0030518634038928802, 'batch': 128, 'epochs': 83}. Best is trial 21 with value: 130.1381627588541.
Best trial: 21. Best value: 130.138:  80%|████████  | 32/40 [17:17<02:05, 15.70s/it]Best trial: 21. Best value: 130.138:  80%|████████  | 32/40 [17:17<02:05, 15.70s/it]Best trial: 21. Best value: 130.138:  82%|████████▎ | 33/40 [17:17<02:20, 20.14s/it]                                                                                    [I 2025-10-06 10:04:03,384] Trial 33 pruned. Trial was pruned at epoch 5.
Best trial: 21. Best value: 130.138:  82%|████████▎ | 33/40 [17:23<02:20, 20.14s/it]Best trial: 21. Best value: 130.138:  82%|████████▎ | 33/40 [17:23<02:20, 20.14s/it]Best trial: 21. Best value: 130.138:  85%|████████▌ | 34/40 [17:23<01:34, 15.82s/it]                                                                                    [I 2025-10-06 10:04:09,261] Trial 34 pruned. Trial was pruned at epoch 5.
Best trial: 21. Best value: 130.138:  85%|████████▌ | 34/40 [17:29<01:34, 15.82s/it]Best trial: 21. Best value: 130.138:  85%|████████▌ | 34/40 [17:29<01:34, 15.82s/it]Best trial: 21. Best value: 130.138:  88%|████████▊ | 35/40 [17:29<01:04, 12.84s/it]                                                                                    [I 2025-10-06 10:04:14,573] Trial 35 pruned. Trial was pruned at epoch 5.
Best trial: 21. Best value: 130.138:  88%|████████▊ | 35/40 [17:34<01:04, 12.84s/it]Best trial: 21. Best value: 130.138:  88%|████████▊ | 35/40 [17:34<01:04, 12.84s/it]Best trial: 21. Best value: 130.138:  90%|█████████ | 36/40 [17:34<00:42, 10.58s/it]                                                                                    [I 2025-10-06 10:04:20,080] Trial 36 pruned. Trial was pruned at epoch 5.
Best trial: 21. Best value: 130.138:  90%|█████████ | 36/40 [17:39<00:42, 10.58s/it]Best trial: 21. Best value: 130.138:  90%|█████████ | 36/40 [17:39<00:42, 10.58s/it]Best trial: 21. Best value: 130.138:  92%|█████████▎| 37/40 [17:39<00:27,  9.06s/it]                                                                                    [I 2025-10-06 10:04:24,219] Trial 37 pruned. Trial was pruned at epoch 5.
Best trial: 21. Best value: 130.138:  92%|█████████▎| 37/40 [17:44<00:27,  9.06s/it]Best trial: 21. Best value: 130.138:  92%|█████████▎| 37/40 [17:44<00:27,  9.06s/it]Best trial: 21. Best value: 130.138:  95%|█████████▌| 38/40 [17:44<00:15,  7.58s/it]                                                                                    [I 2025-10-06 10:04:44,711] Trial 38 finished with value: 130.70499942618875 and parameters: {'seq_len': 24, 'units': 96, 'dropout': 0.2656025680671056, 'lr': 0.0039084980499806375, 'batch': 128, 'epochs': 61}. Best is trial 21 with value: 130.1381627588541.
Best trial: 21. Best value: 130.138:  95%|█████████▌| 38/40 [18:04<00:15,  7.58s/it]Best trial: 21. Best value: 130.138:  95%|█████████▌| 38/40 [18:04<00:15,  7.58s/it]Best trial: 21. Best value: 130.138:  98%|█████████▊| 39/40 [18:04<00:11, 11.46s/it]                                                                                    [I 2025-10-06 10:04:54,136] Trial 39 pruned. Trial was pruned at epoch 5.
Best trial: 21. Best value: 130.138:  98%|█████████▊| 39/40 [18:14<00:11, 11.46s/it]Best trial: 21. Best value: 130.138:  98%|█████████▊| 39/40 [18:14<00:11, 11.46s/it]Best trial: 21. Best value: 130.138: 100%|██████████| 40/40 [18:14<00:00, 10.85s/it]Best trial: 21. Best value: 130.138: 100%|██████████| 40/40 [18:14<00:00, 27.35s/it]
/home/e.ladino/miniconda3/envs/e_ladino/lib/python3.12/site-packages/keras/src/saving/saving_lib.py:797: UserWarning: Skipping variable loading for optimizer 'adam', because it has 2 variables whereas the saved optimizer has 12 variables. 
  saveable.load_own_variables(weights_store.get(inner_path))
Best LSTM params: {'seq_len': 18, 'units': 64, 'dropout': 0.3183509774407929, 'lr': 0.002980651144741477, 'batch': 128, 'epochs': 56}
LSTM test → RMSE: 136.8780 | MAE: 71.1631 | R2: 0.7177 | Skill: 0.303
/mnt/SOLARLAB/E_Ladino/Repo/irradiance-fusion-forecast/Notebooks/05_ground_hpo_optuna_v1.py:141: FutureWarning: The import path :class:`~optuna.storages.JournalFileOpenLock` has been deprecated in v4.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v4.0.0. Use :class:`~optuna.storages.journal.JournalFileOpenLock` instead.
  file_storage = JournalFileStorage(str(log_path), lock_obj=JournalFileOpenLock(str(lock_path)))
/mnt/SOLARLAB/E_Ladino/Repo/irradiance-fusion-forecast/Notebooks/05_ground_hpo_optuna_v1.py:141: FutureWarning: JournalFileStorage has been deprecated in v4.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v4.0.0. Use :class:`~optuna.storages.journal.JournalFileBackend` instead.
  file_storage = JournalFileStorage(str(log_path), lock_obj=JournalFileOpenLock(str(lock_path)))
[I 2025-10-06 10:04:54,519] A new study created in Journal with name: ground_trackB_bilstm
Running Study B2 (BiLSTM)…
  0%|          | 0/35 [00:00<?, ?it/s]                                      [I 2025-10-06 10:06:09,952] Trial 0 finished with value: 221.9838377421879 and parameters: {'seq_len': 12, 'units': 32, 'dropout': 0.062397808134481064, 'lr': 6.533369619026643e-05, 'batch': 64, 'epochs': 41}. Best is trial 0 with value: 221.9838377421879.
  0%|          | 0/35 [01:15<?, ?it/s]Best trial: 0. Best value: 221.984:   0%|          | 0/35 [01:15<?, ?it/s]Best trial: 0. Best value: 221.984:   3%|▎         | 1/35 [01:15<42:44, 75.43s/it]                                                                                  [I 2025-10-06 10:06:42,383] Trial 1 finished with value: 155.71954959156542 and parameters: {'seq_len': 6, 'units': 32, 'dropout': 0.1216968971838151, 'lr': 0.0005603803105930283, 'batch': 256, 'epochs': 51}. Best is trial 1 with value: 155.71954959156542.
Best trial: 0. Best value: 221.984:   3%|▎         | 1/35 [01:47<42:44, 75.43s/it]Best trial: 1. Best value: 155.72:   3%|▎         | 1/35 [01:47<42:44, 75.43s/it] Best trial: 1. Best value: 155.72:   6%|▌         | 2/35 [01:47<27:34, 50.14s/it]                                                                                 [I 2025-10-06 10:07:35,909] Trial 2 finished with value: 132.0135528080356 and parameters: {'seq_len': 24, 'units': 32, 'dropout': 0.20569377536544464, 'lr': 0.000765242606091573, 'batch': 128, 'epochs': 45}. Best is trial 2 with value: 132.0135528080356.
Best trial: 1. Best value: 155.72:   6%|▌         | 2/35 [02:41<27:34, 50.14s/it]Best trial: 2. Best value: 132.014:   6%|▌         | 2/35 [02:41<27:34, 50.14s/it]Best trial: 2. Best value: 132.014:   9%|▊         | 3/35 [02:41<27:33, 51.68s/it]                                                                                  [I 2025-10-06 10:09:07,601] Trial 3 finished with value: 132.03171227729723 and parameters: {'seq_len': 12, 'units': 32, 'dropout': 0.2736932106048628, 'lr': 0.0003795552402641347, 'batch': 128, 'epochs': 113}. Best is trial 2 with value: 132.0135528080356.
Best trial: 2. Best value: 132.014:   9%|▊         | 3/35 [04:13<27:33, 51.68s/it]Best trial: 2. Best value: 132.014:   9%|▊         | 3/35 [04:13<27:33, 51.68s/it]Best trial: 2. Best value: 132.014:  11%|█▏        | 4/35 [04:13<34:51, 67.48s/it]                                                                                  [I 2025-10-06 10:09:28,772] Trial 4 finished with value: 131.5417813258396 and parameters: {'seq_len': 12, 'units': 96, 'dropout': 0.07394178221021082, 'lr': 0.004346495755569775, 'batch': 128, 'epochs': 88}. Best is trial 4 with value: 131.5417813258396.
Best trial: 2. Best value: 132.014:  11%|█▏        | 4/35 [04:34<34:51, 67.48s/it]Best trial: 4. Best value: 131.542:  11%|█▏        | 4/35 [04:34<34:51, 67.48s/it]Best trial: 4. Best value: 131.542:  14%|█▍        | 5/35 [04:34<25:23, 50.78s/it]                                                                                  [I 2025-10-06 10:11:15,561] Trial 5 finished with value: 133.58543468273402 and parameters: {'seq_len': 6, 'units': 64, 'dropout': 0.15547091587579281, 'lr': 0.0001744488327445185, 'batch': 64, 'epochs': 83}. Best is trial 4 with value: 131.5417813258396.
Best trial: 4. Best value: 131.542:  14%|█▍        | 5/35 [06:21<25:23, 50.78s/it]Best trial: 4. Best value: 131.542:  14%|█▍        | 5/35 [06:21<25:23, 50.78s/it]Best trial: 4. Best value: 131.542:  17%|█▋        | 6/35 [06:21<33:44, 69.82s/it]                                                                                  [I 2025-10-06 10:14:19,298] Trial 6 finished with value: 133.82844516161353 and parameters: {'seq_len': 24, 'units': 128, 'dropout': 0.07948627261366897, 'lr': 5.12878198709283e-05, 'batch': 64, 'epochs': 102}. Best is trial 4 with value: 131.5417813258396.
Best trial: 4. Best value: 131.542:  17%|█▋        | 6/35 [09:24<33:44, 69.82s/it]Best trial: 4. Best value: 131.542:  17%|█▋        | 6/35 [09:24<33:44, 69.82s/it]Best trial: 4. Best value: 131.542:  20%|██        | 7/35 [09:24<49:57, 107.06s/it]                                                                                   [I 2025-10-06 10:15:29,889] Trial 7 finished with value: 182.8345392697999 and parameters: {'seq_len': 24, 'units': 96, 'dropout': 0.13235920994105968, 'lr': 6.700183621677408e-05, 'batch': 256, 'epochs': 91}. Best is trial 4 with value: 131.5417813258396.
Best trial: 4. Best value: 131.542:  20%|██        | 7/35 [10:35<49:57, 107.06s/it]Best trial: 4. Best value: 131.542:  20%|██        | 7/35 [10:35<49:57, 107.06s/it]Best trial: 4. Best value: 131.542:  23%|██▎       | 8/35 [10:35<42:57, 95.45s/it]                                                                                   [I 2025-10-06 10:15:52,059] Trial 8 finished with value: 131.80154945030046 and parameters: {'seq_len': 6, 'units': 128, 'dropout': 0.2245108790277985, 'lr': 0.0017414233532634423, 'batch': 128, 'epochs': 42}. Best is trial 4 with value: 131.5417813258396.
Best trial: 4. Best value: 131.542:  23%|██▎       | 8/35 [10:57<42:57, 95.45s/it]Best trial: 4. Best value: 131.542:  23%|██▎       | 8/35 [10:57<42:57, 95.45s/it]Best trial: 4. Best value: 131.542:  26%|██▌       | 9/35 [10:57<31:26, 72.54s/it]                                                                                  [I 2025-10-06 10:16:44,470] Trial 9 finished with value: 140.14026176923605 and parameters: {'seq_len': 18, 'units': 96, 'dropout': 0.3630265895704372, 'lr': 0.00015759936475969445, 'batch': 128, 'epochs': 46}. Best is trial 4 with value: 131.5417813258396.
Best trial: 4. Best value: 131.542:  26%|██▌       | 9/35 [11:49<31:26, 72.54s/it]Best trial: 4. Best value: 131.542:  26%|██▌       | 9/35 [11:49<31:26, 72.54s/it]Best trial: 4. Best value: 131.542:  29%|██▊       | 10/35 [11:49<27:38, 66.33s/it]                                                                                   [I 2025-10-06 10:17:03,900] Trial 10 finished with value: 132.95272009722103 and parameters: {'seq_len': 12, 'units': 64, 'dropout': 0.003018927726517212, 'lr': 0.004065894145021779, 'batch': 128, 'epochs': 67}. Best is trial 4 with value: 131.5417813258396.
Best trial: 4. Best value: 131.542:  29%|██▊       | 10/35 [12:09<27:38, 66.33s/it]Best trial: 4. Best value: 131.542:  29%|██▊       | 10/35 [12:09<27:38, 66.33s/it]Best trial: 4. Best value: 131.542:  31%|███▏      | 11/35 [12:09<20:47, 51.97s/it]                                                                                   [I 2025-10-06 10:17:21,868] Trial 11 finished with value: 132.01777667941164 and parameters: {'seq_len': 6, 'units': 128, 'dropout': 0.25075345796262716, 'lr': 0.004708150953017604, 'batch': 128, 'epochs': 68}. Best is trial 4 with value: 131.5417813258396.
Best trial: 4. Best value: 131.542:  31%|███▏      | 11/35 [12:27<20:47, 51.97s/it]Best trial: 4. Best value: 131.542:  31%|███▏      | 11/35 [12:27<20:47, 51.97s/it]Best trial: 4. Best value: 131.542:  34%|███▍      | 12/35 [12:27<15:57, 41.63s/it]                                                                                   [I 2025-10-06 10:17:57,221] Trial 12 finished with value: 131.7512600746194 and parameters: {'seq_len': 18, 'units': 128, 'dropout': 0.320783922424235, 'lr': 0.0018208433729206238, 'batch': 128, 'epochs': 66}. Best is trial 4 with value: 131.5417813258396.
Best trial: 4. Best value: 131.542:  34%|███▍      | 12/35 [13:02<15:57, 41.63s/it]Best trial: 4. Best value: 131.542:  34%|███▍      | 12/35 [13:02<15:57, 41.63s/it]Best trial: 4. Best value: 131.542:  37%|███▋      | 13/35 [13:02<14:34, 39.73s/it]                                                                                   [I 2025-10-06 10:18:25,808] Trial 13 finished with value: 130.5752821052859 and parameters: {'seq_len': 18, 'units': 96, 'dropout': 0.3673272965336669, 'lr': 0.0019082778124317615, 'batch': 128, 'epochs': 67}. Best is trial 13 with value: 130.5752821052859.
Best trial: 4. Best value: 131.542:  37%|███▋      | 13/35 [13:31<14:34, 39.73s/it]Best trial: 13. Best value: 130.575:  37%|███▋      | 13/35 [13:31<14:34, 39.73s/it]Best trial: 13. Best value: 130.575:  40%|████      | 14/35 [13:31<12:43, 36.36s/it]                                                                                    [I 2025-10-06 10:18:48,690] Trial 14 finished with value: 131.1730801388951 and parameters: {'seq_len': 18, 'units': 96, 'dropout': 0.3495255694148705, 'lr': 0.002716732677869539, 'batch': 128, 'epochs': 81}. Best is trial 13 with value: 130.5752821052859.
Best trial: 13. Best value: 130.575:  40%|████      | 14/35 [13:54<12:43, 36.36s/it]Best trial: 13. Best value: 130.575:  40%|████      | 14/35 [13:54<12:43, 36.36s/it]Best trial: 13. Best value: 130.575:  43%|████▎     | 15/35 [13:54<10:45, 32.30s/it]                                                                                    [I 2025-10-06 10:19:13,935] Trial 15 finished with value: 131.03726062412554 and parameters: {'seq_len': 18, 'units': 96, 'dropout': 0.36708884144982235, 'lr': 0.0015665605271650445, 'batch': 256, 'epochs': 75}. Best is trial 13 with value: 130.5752821052859.
Best trial: 13. Best value: 130.575:  43%|████▎     | 15/35 [14:19<10:45, 32.30s/it]Best trial: 13. Best value: 130.575:  43%|████▎     | 15/35 [14:19<10:45, 32.30s/it]Best trial: 13. Best value: 130.575:  46%|████▌     | 16/35 [14:19<09:33, 30.18s/it]                                                                                    [I 2025-10-06 10:19:19,116] Trial 16 pruned. Trial was pruned at epoch 5.
Best trial: 13. Best value: 130.575:  46%|████▌     | 16/35 [14:24<09:33, 30.18s/it]Best trial: 13. Best value: 130.575:  46%|████▌     | 16/35 [14:24<09:33, 30.18s/it]Best trial: 13. Best value: 130.575:  49%|████▊     | 17/35 [14:24<06:47, 22.66s/it]                                                                                    [I 2025-10-06 10:19:51,396] Trial 17 finished with value: 131.36095756302555 and parameters: {'seq_len': 18, 'units': 96, 'dropout': 0.29646127647197906, 'lr': 0.0010399853318106785, 'batch': 256, 'epochs': 75}. Best is trial 13 with value: 130.5752821052859.
Best trial: 13. Best value: 130.575:  49%|████▊     | 17/35 [14:56<06:47, 22.66s/it]Best trial: 13. Best value: 130.575:  49%|████▊     | 17/35 [14:56<06:47, 22.66s/it]Best trial: 13. Best value: 130.575:  51%|█████▏    | 18/35 [14:56<07:14, 25.55s/it]                                                                                    [I 2025-10-06 10:19:56,708] Trial 18 pruned. Trial was pruned at epoch 5.
Best trial: 13. Best value: 130.575:  51%|█████▏    | 18/35 [15:02<07:14, 25.55s/it]Best trial: 13. Best value: 130.575:  51%|█████▏    | 18/35 [15:02<07:14, 25.55s/it]Best trial: 13. Best value: 130.575:  54%|█████▍    | 19/35 [15:02<05:11, 19.47s/it]                                                                                    [I 2025-10-06 10:20:19,650] Trial 19 finished with value: 131.27193269126496 and parameters: {'seq_len': 18, 'units': 96, 'dropout': 0.335815707793091, 'lr': 0.0023502585100243973, 'batch': 256, 'epochs': 57}. Best is trial 13 with value: 130.5752821052859.
Best trial: 13. Best value: 130.575:  54%|█████▍    | 19/35 [15:25<05:11, 19.47s/it]Best trial: 13. Best value: 130.575:  54%|█████▍    | 19/35 [15:25<05:11, 19.47s/it]Best trial: 13. Best value: 130.575:  57%|█████▋    | 20/35 [15:25<05:07, 20.51s/it]                                                                                    [I 2025-10-06 10:20:25,625] Trial 20 pruned. Trial was pruned at epoch 5.
Best trial: 13. Best value: 130.575:  57%|█████▋    | 20/35 [15:31<05:07, 20.51s/it]Best trial: 13. Best value: 130.575:  57%|█████▋    | 20/35 [15:31<05:07, 20.51s/it]Best trial: 13. Best value: 130.575:  60%|██████    | 21/35 [15:31<03:46, 16.15s/it]                                                                                    [I 2025-10-06 10:21:01,134] Trial 21 finished with value: 130.51208486908405 and parameters: {'seq_len': 18, 'units': 96, 'dropout': 0.3524970769007811, 'lr': 0.0026981873214480786, 'batch': 128, 'epochs': 79}. Best is trial 21 with value: 130.51208486908405.
Best trial: 13. Best value: 130.575:  60%|██████    | 21/35 [16:06<03:46, 16.15s/it]Best trial: 21. Best value: 130.512:  60%|██████    | 21/35 [16:06<03:46, 16.15s/it]Best trial: 21. Best value: 130.512:  63%|██████▎   | 22/35 [16:06<04:45, 21.96s/it]                                                                                    [I 2025-10-06 10:21:28,056] Trial 22 finished with value: 131.4509993662087 and parameters: {'seq_len': 18, 'units': 96, 'dropout': 0.3676734952597942, 'lr': 0.002901586796154443, 'batch': 128, 'epochs': 95}. Best is trial 21 with value: 130.51208486908405.
Best trial: 21. Best value: 130.512:  63%|██████▎   | 22/35 [16:33<04:45, 21.96s/it]Best trial: 21. Best value: 130.512:  63%|██████▎   | 22/35 [16:33<04:45, 21.96s/it]Best trial: 21. Best value: 130.512:  66%|██████▌   | 23/35 [16:33<04:41, 23.45s/it]                                                                                    [I 2025-10-06 10:22:10,317] Trial 23 finished with value: 131.35796898408944 and parameters: {'seq_len': 18, 'units': 96, 'dropout': 0.3186751381161097, 'lr': 0.0016460183337506722, 'batch': 64, 'epochs': 74}. Best is trial 21 with value: 130.51208486908405.
Best trial: 21. Best value: 130.512:  66%|██████▌   | 23/35 [17:15<04:41, 23.45s/it]Best trial: 21. Best value: 130.512:  66%|██████▌   | 23/35 [17:15<04:41, 23.45s/it]Best trial: 21. Best value: 130.512:  69%|██████▊   | 24/35 [17:15<05:20, 29.09s/it]                                                                                    [I 2025-10-06 10:22:43,333] Trial 24 finished with value: 130.91146071629862 and parameters: {'seq_len': 18, 'units': 128, 'dropout': 0.3993649987622624, 'lr': 0.002799385553124246, 'batch': 128, 'epochs': 59}. Best is trial 21 with value: 130.51208486908405.
Best trial: 21. Best value: 130.512:  69%|██████▊   | 24/35 [17:48<05:20, 29.09s/it]Best trial: 21. Best value: 130.512:  69%|██████▊   | 24/35 [17:48<05:20, 29.09s/it]Best trial: 21. Best value: 130.512:  71%|███████▏  | 25/35 [17:48<05:02, 30.27s/it]                                                                                    [I 2025-10-06 10:23:10,420] Trial 25 finished with value: 131.13967089042887 and parameters: {'seq_len': 18, 'units': 128, 'dropout': 0.39849015376209823, 'lr': 0.003073275891214319, 'batch': 128, 'epochs': 59}. Best is trial 21 with value: 130.51208486908405.
Best trial: 21. Best value: 130.512:  71%|███████▏  | 25/35 [18:15<05:02, 30.27s/it]Best trial: 21. Best value: 130.512:  71%|███████▏  | 25/35 [18:15<05:02, 30.27s/it]Best trial: 21. Best value: 130.512:  74%|███████▍  | 26/35 [18:15<04:23, 29.32s/it]                                                                                    [I 2025-10-06 10:23:20,056] Trial 26 pruned. Trial was pruned at epoch 5.
Best trial: 21. Best value: 130.512:  74%|███████▍  | 26/35 [18:25<04:23, 29.32s/it]Best trial: 21. Best value: 130.512:  74%|███████▍  | 26/35 [18:25<04:23, 29.32s/it]Best trial: 21. Best value: 130.512:  77%|███████▋  | 27/35 [18:25<03:07, 23.41s/it]                                                                                    [I 2025-10-06 10:23:47,164] Trial 27 finished with value: 130.7773184892931 and parameters: {'seq_len': 18, 'units': 128, 'dropout': 0.3050670946090331, 'lr': 0.0022076939977520825, 'batch': 128, 'epochs': 51}. Best is trial 21 with value: 130.51208486908405.
Best trial: 21. Best value: 130.512:  77%|███████▋  | 27/35 [18:52<03:07, 23.41s/it]Best trial: 21. Best value: 130.512:  77%|███████▋  | 27/35 [18:52<03:07, 23.41s/it]Best trial: 21. Best value: 130.512:  80%|████████  | 28/35 [18:52<02:51, 24.52s/it]                                                                                    [I 2025-10-06 10:24:17,429] Trial 28 finished with value: 131.21002367387942 and parameters: {'seq_len': 24, 'units': 128, 'dropout': 0.2951664053859999, 'lr': 0.0021325297823448644, 'batch': 128, 'epochs': 52}. Best is trial 21 with value: 130.51208486908405.
Best trial: 21. Best value: 130.512:  80%|████████  | 28/35 [19:22<02:51, 24.52s/it]Best trial: 21. Best value: 130.512:  80%|████████  | 28/35 [19:22<02:51, 24.52s/it]Best trial: 21. Best value: 130.512:  83%|████████▎ | 29/35 [19:22<02:37, 26.24s/it]                                                                                    [I 2025-10-06 10:24:30,059] Trial 29 pruned. Trial was pruned at epoch 5.
Best trial: 21. Best value: 130.512:  83%|████████▎ | 29/35 [19:35<02:37, 26.24s/it]Best trial: 21. Best value: 130.512:  83%|████████▎ | 29/35 [19:35<02:37, 26.24s/it]Best trial: 21. Best value: 130.512:  86%|████████▌ | 30/35 [19:35<01:50, 22.16s/it]                                                                                    [I 2025-10-06 10:24:38,153] Trial 30 pruned. Trial was pruned at epoch 5.
Best trial: 21. Best value: 130.512:  86%|████████▌ | 30/35 [19:43<01:50, 22.16s/it]Best trial: 21. Best value: 130.512:  86%|████████▌ | 30/35 [19:43<01:50, 22.16s/it]Best trial: 21. Best value: 130.512:  89%|████████▊ | 31/35 [19:43<01:11, 17.94s/it]                                                                                    [I 2025-10-06 10:25:04,069] Trial 31 finished with value: 131.20332503408594 and parameters: {'seq_len': 18, 'units': 128, 'dropout': 0.3739226478676664, 'lr': 0.003136281158953299, 'batch': 128, 'epochs': 55}. Best is trial 21 with value: 130.51208486908405.
Best trial: 21. Best value: 130.512:  89%|████████▊ | 31/35 [20:09<01:11, 17.94s/it]Best trial: 21. Best value: 130.512:  89%|████████▊ | 31/35 [20:09<01:11, 17.94s/it]Best trial: 21. Best value: 130.512:  91%|█████████▏| 32/35 [20:09<01:00, 20.33s/it]                                                                                    [I 2025-10-06 10:25:13,141] Trial 32 pruned. Trial was pruned at epoch 5.
Best trial: 21. Best value: 130.512:  91%|█████████▏| 32/35 [20:18<01:00, 20.33s/it]Best trial: 21. Best value: 130.512:  91%|█████████▏| 32/35 [20:18<01:00, 20.33s/it]Best trial: 21. Best value: 130.512:  94%|█████████▍| 33/35 [20:18<00:33, 16.95s/it]                                                                                    [I 2025-10-06 10:25:21,811] Trial 33 pruned. Trial was pruned at epoch 5.
Best trial: 21. Best value: 130.512:  94%|█████████▍| 33/35 [20:27<00:33, 16.95s/it]Best trial: 21. Best value: 130.512:  94%|█████████▍| 33/35 [20:27<00:33, 16.95s/it]Best trial: 21. Best value: 130.512:  97%|█████████▋| 34/35 [20:27<00:14, 14.47s/it]                                                                                    [I 2025-10-06 10:25:30,796] Trial 34 pruned. Trial was pruned at epoch 5.
Best trial: 21. Best value: 130.512:  97%|█████████▋| 34/35 [20:36<00:14, 14.47s/it]Best trial: 21. Best value: 130.512:  97%|█████████▋| 34/35 [20:36<00:14, 14.47s/it]Best trial: 21. Best value: 130.512: 100%|██████████| 35/35 [20:36<00:00, 12.82s/it]Best trial: 21. Best value: 130.512: 100%|██████████| 35/35 [20:36<00:00, 35.32s/it]
/home/e.ladino/miniconda3/envs/e_ladino/lib/python3.12/site-packages/keras/src/saving/saving_lib.py:797: UserWarning: Skipping variable loading for optimizer 'adam', because it has 2 variables whereas the saved optimizer has 18 variables. 
  saveable.load_own_variables(weights_store.get(inner_path))
Best BiLSTM params: {'seq_len': 18, 'units': 96, 'dropout': 0.3524970769007811, 'lr': 0.0026981873214480786, 'batch': 128, 'epochs': 79}
BiLSTM test → RMSE: 136.8247 | MAE: 70.5807 | R2: 0.7180 | Skill: 0.303
/mnt/SOLARLAB/E_Ladino/Repo/irradiance-fusion-forecast/Notebooks/05_ground_hpo_optuna_v1.py:141: FutureWarning: The import path :class:`~optuna.storages.JournalFileOpenLock` has been deprecated in v4.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v4.0.0. Use :class:`~optuna.storages.journal.JournalFileOpenLock` instead.
  file_storage = JournalFileStorage(str(log_path), lock_obj=JournalFileOpenLock(str(lock_path)))
/mnt/SOLARLAB/E_Ladino/Repo/irradiance-fusion-forecast/Notebooks/05_ground_hpo_optuna_v1.py:141: FutureWarning: JournalFileStorage has been deprecated in v4.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v4.0.0. Use :class:`~optuna.storages.journal.JournalFileBackend` instead.
  file_storage = JournalFileStorage(str(log_path), lock_obj=JournalFileOpenLock(str(lock_path)))
[I 2025-10-06 10:25:31,658] A new study created in Journal with name: ground_trackB_cnnlstm
Running Study B3 (CNN-LSTM)…
  0%|          | 0/35 [00:00<?, ?it/s]                                      [I 2025-10-06 10:26:15,738] Trial 0 finished with value: 135.9258543862241 and parameters: {'seq_len': 12, 'filters': 16, 'kernel_size': 5, 'pool': 2, 'lstm_units': 32, 'dropout': 0.38796394086479774, 'lr': 0.002311294500510415, 'batch': 64, 'epochs': 64}. Best is trial 0 with value: 135.9258543862241.
  0%|          | 0/35 [00:44<?, ?it/s]Best trial: 0. Best value: 135.926:   0%|          | 0/35 [00:44<?, ?it/s]Best trial: 0. Best value: 135.926:   3%|▎         | 1/35 [00:44<24:58, 44.08s/it]                                                                                  [I 2025-10-06 10:29:24,574] Trial 1 finished with value: 137.70820174602892 and parameters: {'seq_len': 24, 'filters': 16, 'kernel_size': 5, 'pool': 1, 'lstm_units': 96, 'dropout': 0.236965827544817, 'lr': 6.192568649430468e-05, 'batch': 64, 'epochs': 116}. Best is trial 0 with value: 135.9258543862241.
Best trial: 0. Best value: 135.926:   3%|▎         | 1/35 [03:52<24:58, 44.08s/it]Best trial: 0. Best value: 135.926:   3%|▎         | 1/35 [03:52<24:58, 44.08s/it]Best trial: 0. Best value: 135.926:   6%|▌         | 2/35 [03:52<1:11:04, 129.23s/it]                                                                                     [I 2025-10-06 10:30:54,578] Trial 2 finished with value: 133.19678962206635 and parameters: {'seq_len': 6, 'filters': 48, 'kernel_size': 5, 'pool': 2, 'lstm_units': 64, 'dropout': 0.2650089137415928, 'lr': 0.00021008360271862668, 'batch': 128, 'epochs': 118}. Best is trial 2 with value: 133.19678962206635.
Best trial: 0. Best value: 135.926:   6%|▌         | 2/35 [05:22<1:11:04, 129.23s/it]Best trial: 2. Best value: 133.197:   6%|▌         | 2/35 [05:22<1:11:04, 129.23s/it]Best trial: 2. Best value: 133.197:   9%|▊         | 3/35 [05:22<59:22, 111.32s/it]                                                                                     [I 2025-10-06 10:32:17,957] Trial 3 finished with value: 136.32550230285236 and parameters: {'seq_len': 12, 'filters': 64, 'kernel_size': 3, 'pool': 2, 'lstm_units': 64, 'dropout': 0.3314950036607718, 'lr': 0.0002585095893183495, 'batch': 128, 'epochs': 104}. Best is trial 2 with value: 133.19678962206635.
Best trial: 2. Best value: 133.197:   9%|▊         | 3/35 [06:46<59:22, 111.32s/it]Best trial: 2. Best value: 133.197:   9%|▊         | 3/35 [06:46<59:22, 111.32s/it]Best trial: 2. Best value: 133.197:  11%|█▏        | 4/35 [06:46<51:48, 100.29s/it]                                                                                   [I 2025-10-06 10:32:50,399] Trial 4 finished with value: 132.69245309879156 and parameters: {'seq_len': 12, 'filters': 16, 'kernel_size': 2, 'pool': 1, 'lstm_units': 64, 'dropout': 0.04634762381005189, 'lr': 0.002661808797375751, 'batch': 64, 'epochs': 65}. Best is trial 4 with value: 132.69245309879156.
Best trial: 2. Best value: 133.197:  11%|█▏        | 4/35 [07:18<51:48, 100.29s/it]Best trial: 4. Best value: 132.692:  11%|█▏        | 4/35 [07:18<51:48, 100.29s/it]Best trial: 4. Best value: 132.692:  14%|█▍        | 5/35 [07:18<37:54, 75.82s/it]                                                                                   [I 2025-10-06 10:34:04,846] Trial 5 finished with value: 135.18172086584045 and parameters: {'seq_len': 24, 'filters': 32, 'kernel_size': 5, 'pool': 2, 'lstm_units': 64, 'dropout': 0.20909313175279765, 'lr': 0.00035813934999486707, 'batch': 128, 'epochs': 91}. Best is trial 4 with value: 132.69245309879156.
Best trial: 4. Best value: 132.692:  14%|█▍        | 5/35 [08:33<37:54, 75.82s/it]Best trial: 4. Best value: 132.692:  14%|█▍        | 5/35 [08:33<37:54, 75.82s/it]Best trial: 4. Best value: 132.692:  17%|█▋        | 6/35 [08:33<36:25, 75.35s/it]                                                                                  [I 2025-10-06 10:34:52,441] Trial 6 finished with value: 132.07209057698375 and parameters: {'seq_len': 18, 'filters': 32, 'kernel_size': 2, 'pool': 1, 'lstm_units': 128, 'dropout': 0.3232481518257668, 'lr': 0.000924224586049431, 'batch': 64, 'epochs': 112}. Best is trial 6 with value: 132.07209057698375.
Best trial: 4. Best value: 132.692:  17%|█▋        | 6/35 [09:20<36:25, 75.35s/it]Best trial: 6. Best value: 132.072:  17%|█▋        | 6/35 [09:20<36:25, 75.35s/it]Best trial: 6. Best value: 132.072:  20%|██        | 7/35 [09:20<30:55, 66.28s/it]                                                                                  [I 2025-10-06 10:35:37,404] Trial 7 finished with value: 206.25314391543222 and parameters: {'seq_len': 18, 'filters': 16, 'kernel_size': 5, 'pool': 1, 'lstm_units': 96, 'dropout': 0.16696440125951162, 'lr': 0.0001390546848963277, 'batch': 256, 'epochs': 66}. Best is trial 6 with value: 132.07209057698375.
Best trial: 6. Best value: 132.072:  20%|██        | 7/35 [10:05<30:55, 66.28s/it]Best trial: 6. Best value: 132.072:  20%|██        | 7/35 [10:05<30:55, 66.28s/it]Best trial: 6. Best value: 132.072:  23%|██▎       | 8/35 [10:05<26:46, 59.49s/it]                                                                                  [I 2025-10-06 10:35:46,510] Trial 8 pruned. Trial was pruned at epoch 5.
Best trial: 6. Best value: 132.072:  23%|██▎       | 8/35 [10:14<26:46, 59.49s/it]Best trial: 6. Best value: 132.072:  23%|██▎       | 8/35 [10:14<26:46, 59.49s/it]Best trial: 6. Best value: 132.072:  26%|██▌       | 9/35 [10:14<18:57, 43.74s/it]                                                                                  [I 2025-10-06 10:36:22,602] Trial 9 finished with value: 132.73093819123332 and parameters: {'seq_len': 12, 'filters': 64, 'kernel_size': 3, 'pool': 2, 'lstm_units': 96, 'dropout': 0.03611590802176332, 'lr': 0.0023419358540593647, 'batch': 64, 'epochs': 87}. Best is trial 6 with value: 132.07209057698375.
Best trial: 6. Best value: 132.072:  26%|██▌       | 9/35 [10:50<18:57, 43.74s/it]Best trial: 6. Best value: 132.072:  26%|██▌       | 9/35 [10:50<18:57, 43.74s/it]Best trial: 6. Best value: 132.072:  29%|██▊       | 10/35 [10:50<17:14, 41.38s/it]                                                                                   [I 2025-10-06 10:37:03,803] Trial 10 finished with value: 133.38175064921737 and parameters: {'seq_len': 18, 'filters': 32, 'kernel_size': 2, 'pool': 1, 'lstm_units': 128, 'dropout': 0.3208799472720689, 'lr': 0.0008200741601320914, 'batch': 256, 'epochs': 100}. Best is trial 6 with value: 132.07209057698375.
Best trial: 6. Best value: 132.072:  29%|██▊       | 10/35 [11:32<17:14, 41.38s/it]Best trial: 6. Best value: 132.072:  29%|██▊       | 10/35 [11:32<17:14, 41.38s/it]Best trial: 6. Best value: 132.072:  31%|███▏      | 11/35 [11:32<16:31, 41.33s/it]                                                                                   [I 2025-10-06 10:37:41,308] Trial 11 finished with value: 131.05451215524783 and parameters: {'seq_len': 18, 'filters': 32, 'kernel_size': 2, 'pool': 1, 'lstm_units': 128, 'dropout': 0.02712810710504837, 'lr': 0.0009191014050706828, 'batch': 64, 'epochs': 75}. Best is trial 11 with value: 131.05451215524783.
Best trial: 6. Best value: 132.072:  31%|███▏      | 11/35 [12:09<16:31, 41.33s/it]Best trial: 11. Best value: 131.055:  31%|███▏      | 11/35 [12:09<16:31, 41.33s/it]Best trial: 11. Best value: 131.055:  34%|███▍      | 12/35 [12:09<15:23, 40.16s/it]                                                                                    [I 2025-10-06 10:38:17,866] Trial 12 finished with value: 131.81511525380918 and parameters: {'seq_len': 18, 'filters': 32, 'kernel_size': 2, 'pool': 1, 'lstm_units': 128, 'dropout': 0.11800943075598573, 'lr': 0.0009000277393655389, 'batch': 64, 'epochs': 76}. Best is trial 11 with value: 131.05451215524783.
Best trial: 11. Best value: 131.055:  34%|███▍      | 12/35 [12:46<15:23, 40.16s/it]Best trial: 11. Best value: 131.055:  34%|███▍      | 12/35 [12:46<15:23, 40.16s/it]Best trial: 11. Best value: 131.055:  37%|███▋      | 13/35 [12:46<14:19, 39.07s/it]                                                                                    [I 2025-10-06 10:38:54,289] Trial 13 finished with value: 131.3946375665689 and parameters: {'seq_len': 18, 'filters': 48, 'kernel_size': 2, 'pool': 1, 'lstm_units': 128, 'dropout': 0.10858005715109262, 'lr': 0.0009311434837451578, 'batch': 64, 'epochs': 77}. Best is trial 11 with value: 131.05451215524783.
Best trial: 11. Best value: 131.055:  37%|███▋      | 13/35 [13:22<14:19, 39.07s/it]Best trial: 11. Best value: 131.055:  37%|███▋      | 13/35 [13:22<14:19, 39.07s/it]Best trial: 11. Best value: 131.055:  40%|████      | 14/35 [13:22<13:23, 38.27s/it]                                                                                    [I 2025-10-06 10:39:28,867] Trial 14 finished with value: 131.24534217925603 and parameters: {'seq_len': 18, 'filters': 48, 'kernel_size': 2, 'pool': 1, 'lstm_units': 128, 'dropout': 0.10289531425438014, 'lr': 0.0013339821465659144, 'batch': 64, 'epochs': 77}. Best is trial 11 with value: 131.05451215524783.
Best trial: 11. Best value: 131.055:  40%|████      | 14/35 [13:57<13:23, 38.27s/it]Best trial: 11. Best value: 131.055:  40%|████      | 14/35 [13:57<13:23, 38.27s/it]Best trial: 11. Best value: 131.055:  43%|████▎     | 15/35 [13:57<12:23, 37.16s/it]                                                                                    [I 2025-10-06 10:39:50,914] Trial 15 finished with value: 131.61876023908977 and parameters: {'seq_len': 6, 'filters': 48, 'kernel_size': 2, 'pool': 1, 'lstm_units': 128, 'dropout': 0.0859486412411985, 'lr': 0.004548007664220133, 'batch': 64, 'epochs': 50}. Best is trial 11 with value: 131.05451215524783.
Best trial: 11. Best value: 131.055:  43%|████▎     | 15/35 [14:19<12:23, 37.16s/it]Best trial: 11. Best value: 131.055:  43%|████▎     | 15/35 [14:19<12:23, 37.16s/it]Best trial: 11. Best value: 131.055:  46%|████▌     | 16/35 [14:19<10:19, 32.61s/it]                                                                                    [I 2025-10-06 10:39:55,439] Trial 16 pruned. Trial was pruned at epoch 5.
Best trial: 11. Best value: 131.055:  46%|████▌     | 16/35 [14:23<10:19, 32.61s/it]Best trial: 11. Best value: 131.055:  46%|████▌     | 16/35 [14:23<10:19, 32.61s/it]Best trial: 11. Best value: 131.055:  49%|████▊     | 17/35 [14:23<07:14, 24.16s/it]                                                                                    [I 2025-10-06 10:40:30,704] Trial 17 finished with value: 131.33532196966283 and parameters: {'seq_len': 18, 'filters': 48, 'kernel_size': 2, 'pool': 1, 'lstm_units': 128, 'dropout': 0.1509376605388808, 'lr': 0.00151278754950663, 'batch': 64, 'epochs': 86}. Best is trial 11 with value: 131.05451215524783.
Best trial: 11. Best value: 131.055:  49%|████▊     | 17/35 [14:59<07:14, 24.16s/it]Best trial: 11. Best value: 131.055:  49%|████▊     | 17/35 [14:59<07:14, 24.16s/it]Best trial: 11. Best value: 131.055:  51%|█████▏    | 18/35 [14:59<07:47, 27.50s/it]                                                                                    [I 2025-10-06 10:40:41,768] Trial 18 pruned. Trial was pruned at epoch 5.
Best trial: 11. Best value: 131.055:  51%|█████▏    | 18/35 [15:10<07:47, 27.50s/it]Best trial: 11. Best value: 131.055:  51%|█████▏    | 18/35 [15:10<07:47, 27.50s/it]Best trial: 11. Best value: 131.055:  54%|█████▍    | 19/35 [15:10<06:01, 22.56s/it]                                                                                    [I 2025-10-06 10:40:46,477] Trial 19 pruned. Trial was pruned at epoch 5.
Best trial: 11. Best value: 131.055:  54%|█████▍    | 19/35 [15:14<06:01, 22.56s/it]Best trial: 11. Best value: 131.055:  54%|█████▍    | 19/35 [15:14<06:01, 22.56s/it]Best trial: 11. Best value: 131.055:  57%|█████▋    | 20/35 [15:14<04:18, 17.20s/it]                                                                                    [I 2025-10-06 10:41:19,439] Trial 20 finished with value: 131.84207231096605 and parameters: {'seq_len': 18, 'filters': 32, 'kernel_size': 3, 'pool': 1, 'lstm_units': 96, 'dropout': 0.13904201638798758, 'lr': 0.003824733457735936, 'batch': 64, 'epochs': 56}. Best is trial 11 with value: 131.05451215524783.
Best trial: 11. Best value: 131.055:  57%|█████▋    | 20/35 [15:47<04:18, 17.20s/it]Best trial: 11. Best value: 131.055:  57%|█████▋    | 20/35 [15:47<04:18, 17.20s/it]Best trial: 11. Best value: 131.055:  60%|██████    | 21/35 [15:47<05:07, 21.93s/it]                                                                                    [I 2025-10-06 10:41:59,826] Trial 21 finished with value: 131.78651504184714 and parameters: {'seq_len': 18, 'filters': 48, 'kernel_size': 2, 'pool': 1, 'lstm_units': 128, 'dropout': 0.1595199172323938, 'lr': 0.0014394508654573949, 'batch': 64, 'epochs': 85}. Best is trial 11 with value: 131.05451215524783.
Best trial: 11. Best value: 131.055:  60%|██████    | 21/35 [16:28<05:07, 21.93s/it]Best trial: 11. Best value: 131.055:  60%|██████    | 21/35 [16:28<05:07, 21.93s/it]Best trial: 11. Best value: 131.055:  63%|██████▎   | 22/35 [16:28<05:57, 27.47s/it]                                                                                    [I 2025-10-06 10:42:38,482] Trial 22 finished with value: 131.64916978944456 and parameters: {'seq_len': 18, 'filters': 48, 'kernel_size': 2, 'pool': 1, 'lstm_units': 128, 'dropout': 0.09356120900182516, 'lr': 0.001621686922126068, 'batch': 64, 'epochs': 81}. Best is trial 11 with value: 131.05451215524783.
Best trial: 11. Best value: 131.055:  63%|██████▎   | 22/35 [17:06<05:57, 27.47s/it]Best trial: 11. Best value: 131.055:  63%|██████▎   | 22/35 [17:06<05:57, 27.47s/it]Best trial: 11. Best value: 131.055:  66%|██████▌   | 23/35 [17:06<06:09, 30.83s/it]                                                                                    [I 2025-10-06 10:42:50,401] Trial 23 pruned. Trial was pruned at epoch 5.
Best trial: 11. Best value: 131.055:  66%|██████▌   | 23/35 [17:18<06:09, 30.83s/it]Best trial: 11. Best value: 131.055:  66%|██████▌   | 23/35 [17:18<06:09, 30.83s/it]Best trial: 11. Best value: 131.055:  69%|██████▊   | 24/35 [17:18<04:36, 25.15s/it]                                                                                    [I 2025-10-06 10:43:25,131] Trial 24 finished with value: 131.57155550783003 and parameters: {'seq_len': 18, 'filters': 48, 'kernel_size': 2, 'pool': 1, 'lstm_units': 128, 'dropout': 0.1556423175104839, 'lr': 0.0016050902245668206, 'batch': 64, 'epochs': 82}. Best is trial 11 with value: 131.05451215524783.
Best trial: 11. Best value: 131.055:  69%|██████▊   | 24/35 [17:53<04:36, 25.15s/it]Best trial: 11. Best value: 131.055:  69%|██████▊   | 24/35 [17:53<04:36, 25.15s/it]Best trial: 11. Best value: 131.055:  71%|███████▏  | 25/35 [17:53<04:40, 28.03s/it]                                                                                    [I 2025-10-06 10:43:42,104] Trial 25 pruned. Trial was pruned at epoch 9.
Best trial: 11. Best value: 131.055:  71%|███████▏  | 25/35 [18:10<04:40, 28.03s/it]Best trial: 11. Best value: 131.055:  71%|███████▏  | 25/35 [18:10<04:40, 28.03s/it]Best trial: 11. Best value: 131.055:  74%|███████▍  | 26/35 [18:10<03:42, 24.71s/it]                                                                                    [I 2025-10-06 10:44:08,664] Trial 26 finished with value: 131.7727091434338 and parameters: {'seq_len': 18, 'filters': 48, 'kernel_size': 2, 'pool': 2, 'lstm_units': 128, 'dropout': 0.08111610997884844, 'lr': 0.0031235792356209807, 'batch': 64, 'epochs': 58}. Best is trial 11 with value: 131.05451215524783.
Best trial: 11. Best value: 131.055:  74%|███████▍  | 26/35 [18:37<03:42, 24.71s/it]Best trial: 11. Best value: 131.055:  74%|███████▍  | 26/35 [18:37<03:42, 24.71s/it]Best trial: 11. Best value: 131.055:  77%|███████▋  | 27/35 [18:37<03:22, 25.27s/it]                                                                                    [I 2025-10-06 10:44:42,979] Trial 27 finished with value: 131.87430390811548 and parameters: {'seq_len': 24, 'filters': 64, 'kernel_size': 2, 'pool': 1, 'lstm_units': 96, 'dropout': 0.1801835944852071, 'lr': 0.001961012341385061, 'batch': 64, 'epochs': 72}. Best is trial 11 with value: 131.05451215524783.
Best trial: 11. Best value: 131.055:  77%|███████▋  | 27/35 [19:11<03:22, 25.27s/it]Best trial: 11. Best value: 131.055:  77%|███████▋  | 27/35 [19:11<03:22, 25.27s/it]Best trial: 11. Best value: 131.055:  80%|████████  | 28/35 [19:11<03:15, 27.98s/it]                                                                                    [I 2025-10-06 10:44:49,637] Trial 28 pruned. Trial was pruned at epoch 5.
Best trial: 11. Best value: 131.055:  80%|████████  | 28/35 [19:17<03:15, 27.98s/it]Best trial: 11. Best value: 131.055:  80%|████████  | 28/35 [19:17<03:15, 27.98s/it]Best trial: 11. Best value: 131.055:  83%|████████▎ | 29/35 [19:17<02:09, 21.58s/it]                                                                                    [I 2025-10-06 10:44:56,661] Trial 29 pruned. Trial was pruned at epoch 5.
Best trial: 11. Best value: 131.055:  83%|████████▎ | 29/35 [19:25<02:09, 21.58s/it]Best trial: 11. Best value: 131.055:  83%|████████▎ | 29/35 [19:25<02:09, 21.58s/it]Best trial: 11. Best value: 131.055:  86%|████████▌ | 30/35 [19:25<01:26, 17.22s/it]                                                                                    [I 2025-10-06 10:45:07,879] Trial 30 pruned. Trial was pruned at epoch 5.
Best trial: 11. Best value: 131.055:  86%|████████▌ | 30/35 [19:36<01:26, 17.22s/it]Best trial: 11. Best value: 131.055:  86%|████████▌ | 30/35 [19:36<01:26, 17.22s/it]Best trial: 11. Best value: 131.055:  89%|████████▊ | 31/35 [19:36<01:01, 15.42s/it]                                                                                    [I 2025-10-06 10:45:19,279] Trial 31 pruned. Trial was pruned at epoch 5.
Best trial: 11. Best value: 131.055:  89%|████████▊ | 31/35 [19:47<01:01, 15.42s/it]Best trial: 11. Best value: 131.055:  89%|████████▊ | 31/35 [19:47<01:01, 15.42s/it]Best trial: 11. Best value: 131.055:  91%|█████████▏| 32/35 [19:47<00:42, 14.21s/it]                                                                                    [I 2025-10-06 10:45:34,218] Trial 32 pruned. Trial was pruned at epoch 7.
Best trial: 11. Best value: 131.055:  91%|█████████▏| 32/35 [20:02<00:42, 14.21s/it]Best trial: 11. Best value: 131.055:  91%|█████████▏| 32/35 [20:02<00:42, 14.21s/it]Best trial: 11. Best value: 131.055:  94%|█████████▍| 33/35 [20:02<00:28, 14.43s/it]                                                                                    [I 2025-10-06 10:46:02,902] Trial 33 finished with value: 131.2674095596466 and parameters: {'seq_len': 18, 'filters': 48, 'kernel_size': 2, 'pool': 1, 'lstm_units': 128, 'dropout': 0.13491008325497722, 'lr': 0.0019954156437434153, 'batch': 64, 'epochs': 86}. Best is trial 11 with value: 131.05451215524783.
Best trial: 11. Best value: 131.055:  94%|█████████▍| 33/35 [20:31<00:28, 14.43s/it]Best trial: 11. Best value: 131.055:  94%|█████████▍| 33/35 [20:31<00:28, 14.43s/it]Best trial: 11. Best value: 131.055:  97%|█████████▋| 34/35 [20:31<00:18, 18.71s/it]                                                                                    [I 2025-10-06 10:46:38,992] Trial 34 finished with value: 131.8614921992012 and parameters: {'seq_len': 18, 'filters': 48, 'kernel_size': 2, 'pool': 1, 'lstm_units': 128, 'dropout': 0.3967825861452995, 'lr': 0.0022037731329048477, 'batch': 64, 'epochs': 86}. Best is trial 11 with value: 131.05451215524783.
Best trial: 11. Best value: 131.055:  97%|█████████▋| 34/35 [21:07<00:18, 18.71s/it]Best trial: 11. Best value: 131.055:  97%|█████████▋| 34/35 [21:07<00:18, 18.71s/it]Best trial: 11. Best value: 131.055: 100%|██████████| 35/35 [21:07<00:00, 23.92s/it]Best trial: 11. Best value: 131.055: 100%|██████████| 35/35 [21:07<00:00, 36.21s/it]
/home/e.ladino/miniconda3/envs/e_ladino/lib/python3.12/site-packages/keras/src/saving/saving_lib.py:797: UserWarning: Skipping variable loading for optimizer 'adam', because it has 2 variables whereas the saved optimizer has 16 variables. 
  saveable.load_own_variables(weights_store.get(inner_path))
Best CNN-LSTM params: {'seq_len': 18, 'filters': 32, 'kernel_size': 2, 'pool': 1, 'lstm_units': 128, 'dropout': 0.02712810710504837, 'lr': 0.0009191014050706828, 'batch': 64, 'epochs': 75}
CNN-LSTM test → RMSE: 138.7057 | MAE: 70.8367 | R2: 0.7102 | Skill: 0.294
/mnt/SOLARLAB/E_Ladino/Repo/irradiance-fusion-forecast/Notebooks/05_ground_hpo_optuna_v1.py:141: FutureWarning: The import path :class:`~optuna.storages.JournalFileOpenLock` has been deprecated in v4.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v4.0.0. Use :class:`~optuna.storages.journal.JournalFileOpenLock` instead.
  file_storage = JournalFileStorage(str(log_path), lock_obj=JournalFileOpenLock(str(lock_path)))
/mnt/SOLARLAB/E_Ladino/Repo/irradiance-fusion-forecast/Notebooks/05_ground_hpo_optuna_v1.py:141: FutureWarning: JournalFileStorage has been deprecated in v4.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v4.0.0. Use :class:`~optuna.storages.journal.JournalFileBackend` instead.
  file_storage = JournalFileStorage(str(log_path), lock_obj=JournalFileOpenLock(str(lock_path)))
[I 2025-10-06 10:46:39,571] A new study created in Journal with name: ground_trackB_transformer
Running Study B4 (Transformer)…
  0%|          | 0/40 [00:00<?, ?it/s]2025-10-06 10:46:42.372036: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 332 bytes spill stores, 332 bytes spill loads

2025-10-06 10:46:42.491419: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 360 bytes spill stores, 360 bytes spill loads

2025-10-06 10:46:42.752089: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_11', 144 bytes spill stores, 144 bytes spill loads

2025-10-06 10:46:44.618973: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_31', 8 bytes spill stores, 8 bytes spill loads

2025-10-06 10:46:44.727427: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_31', 20 bytes spill stores, 20 bytes spill loads

2025-10-06 10:46:45.010964: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 168 bytes spill stores, 168 bytes spill loads

2025-10-06 10:46:45.117816: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 200 bytes spill stores, 200 bytes spill loads

2025-10-06 10:46:47.081810: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_10', 20 bytes spill stores, 20 bytes spill loads

2025-10-06 10:46:47.126746: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_10', 8 bytes spill stores, 8 bytes spill loads

2025-10-06 10:46:47.153513: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 168 bytes spill stores, 168 bytes spill loads

2025-10-06 10:46:47.211931: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 200 bytes spill stores, 200 bytes spill loads

2025-10-06 10:47:00.296016: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 200 bytes spill stores, 200 bytes spill loads

2025-10-06 10:47:00.335535: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 360 bytes spill stores, 360 bytes spill loads

2025-10-06 10:47:00.999281: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_10', 8 bytes spill stores, 8 bytes spill loads

2025-10-06 10:47:01.049432: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_10', 20 bytes spill stores, 20 bytes spill loads

2025-10-06 10:47:01.112656: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 200 bytes spill stores, 200 bytes spill loads

2025-10-06 10:47:01.177573: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 168 bytes spill stores, 168 bytes spill loads

                                      [I 2025-10-06 10:47:01,561] Trial 0 finished with value: 134.41970913197588 and parameters: {'seq_len': 12, 'd_model': 128, 'heads': 4, 'ff_dim': 64, 'att_dropout': 0.055021352956030146, 'dropout': 0.1216968971838151, 'lr': 0.0005603803105930283, 'batch': 256, 'epochs': 51}. Best is trial 0 with value: 134.41970913197588.
  0%|          | 0/40 [00:21<?, ?it/s]Best trial: 0. Best value: 134.42:   0%|          | 0/40 [00:21<?, ?it/s]Best trial: 0. Best value: 134.42:   2%|▎         | 1/40 [00:21<14:17, 21.99s/it]2025-10-06 10:47:04.365246: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_31', 56 bytes spill stores, 56 bytes spill loads

2025-10-06 10:47:04.379438: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 56 bytes spill stores, 56 bytes spill loads

2025-10-06 10:47:04.399939: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_31', 52 bytes spill stores, 52 bytes spill loads

2025-10-06 10:47:04.527905: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_19', 12 bytes spill stores, 12 bytes spill loads

2025-10-06 10:47:04.723477: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 52 bytes spill stores, 52 bytes spill loads

2025-10-06 10:47:04.779683: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_19', 4 bytes spill stores, 4 bytes spill loads

2025-10-06 10:47:04.789949: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_11', 52 bytes spill stores, 52 bytes spill loads

2025-10-06 10:47:04.812156: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_11', 44 bytes spill stores, 44 bytes spill loads

2025-10-06 10:47:04.813739: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_2435', 12 bytes spill stores, 12 bytes spill loads

2025-10-06 10:47:06.972273: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_31', 56 bytes spill stores, 56 bytes spill loads

2025-10-06 10:47:06.972724: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_31', 56 bytes spill stores, 56 bytes spill loads

2025-10-06 10:47:07.071488: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 56 bytes spill stores, 56 bytes spill loads

2025-10-06 10:47:07.084629: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 56 bytes spill stores, 56 bytes spill loads

2025-10-06 10:47:08.506112: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'input_add_multiply_reduce_fusion', 40 bytes spill stores, 24 bytes spill loads

2025-10-06 10:47:09.491301: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_10', 56 bytes spill stores, 56 bytes spill loads

2025-10-06 10:47:09.529223: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 56 bytes spill stores, 56 bytes spill loads

2025-10-06 10:47:09.557145: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_10', 80 bytes spill stores, 80 bytes spill loads

2025-10-06 10:47:09.572492: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 80 bytes spill stores, 80 bytes spill loads

2025-10-06 10:47:25.264814: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_10', 52 bytes spill stores, 52 bytes spill loads

2025-10-06 10:47:25.278139: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_10', 56 bytes spill stores, 56 bytes spill loads

2025-10-06 10:47:25.305250: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 56 bytes spill stores, 56 bytes spill loads

2025-10-06 10:47:25.340639: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 52 bytes spill stores, 52 bytes spill loads

2025-10-06 10:47:26.333001: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_10', 80 bytes spill stores, 80 bytes spill loads

2025-10-06 10:47:26.367983: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 80 bytes spill stores, 80 bytes spill loads

2025-10-06 10:47:26.384544: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 56 bytes spill stores, 56 bytes spill loads

2025-10-06 10:47:26.418320: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_10', 56 bytes spill stores, 56 bytes spill loads

                                                                                 [I 2025-10-06 10:47:26,976] Trial 1 finished with value: 133.44145925039564 and parameters: {'seq_len': 24, 'd_model': 96, 'heads': 2, 'ff_dim': 96, 'att_dropout': 0.029301634201915158, 'dropout': 0.2736932106048628, 'lr': 0.0003795552402641347, 'batch': 128, 'epochs': 113}. Best is trial 1 with value: 133.44145925039564.
Best trial: 0. Best value: 134.42:   2%|▎         | 1/40 [00:47<14:17, 21.99s/it]Best trial: 1. Best value: 133.441:   2%|▎         | 1/40 [00:47<14:17, 21.99s/it]Best trial: 1. Best value: 133.441:   5%|▌         | 2/40 [00:47<15:12, 24.00s/it]2025-10-06 10:47:30.272533: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_11', 52 bytes spill stores, 52 bytes spill loads

2025-10-06 10:47:30.281809: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 4 bytes spill stores, 4 bytes spill loads

2025-10-06 10:47:30.390647: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_11', 44 bytes spill stores, 44 bytes spill loads

2025-10-06 10:47:32.720058: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_31', 56 bytes spill stores, 56 bytes spill loads

2025-10-06 10:47:32.923566: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_31', 80 bytes spill stores, 80 bytes spill loads

2025-10-06 10:47:32.970296: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 64 bytes spill stores, 64 bytes spill loads

2025-10-06 10:47:33.029692: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 56 bytes spill stores, 56 bytes spill loads

2025-10-06 10:47:35.037179: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_10', 56 bytes spill stores, 56 bytes spill loads

2025-10-06 10:47:35.126486: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_10', 80 bytes spill stores, 80 bytes spill loads

2025-10-06 10:47:35.137600: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 64 bytes spill stores, 64 bytes spill loads

2025-10-06 10:47:35.144638: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 56 bytes spill stores, 56 bytes spill loads

2025-10-06 10:47:57.585859: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_10', 56 bytes spill stores, 56 bytes spill loads

2025-10-06 10:47:57.604957: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_10', 52 bytes spill stores, 52 bytes spill loads

2025-10-06 10:47:57.699043: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 64 bytes spill stores, 64 bytes spill loads

                                                                                  [I 2025-10-06 10:47:58,528] Trial 2 finished with value: 134.13907341123615 and parameters: {'seq_len': 12, 'd_model': 96, 'heads': 2, 'ff_dim': 64, 'att_dropout': 0.0975990992289793, 'dropout': 0.15547091587579281, 'lr': 0.0001744488327445185, 'batch': 64, 'epochs': 83}. Best is trial 1 with value: 133.44145925039564.
Best trial: 1. Best value: 133.441:   5%|▌         | 2/40 [01:18<15:12, 24.00s/it]Best trial: 1. Best value: 133.441:   5%|▌         | 2/40 [01:18<15:12, 24.00s/it]Best trial: 1. Best value: 133.441:   8%|▊         | 3/40 [01:18<16:55, 27.45s/it]2025-10-06 10:48:01.468710: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_19', 8 bytes spill stores, 8 bytes spill loads

2025-10-06 10:48:01.686054: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_2431', 24 bytes spill stores, 24 bytes spill loads

2025-10-06 10:48:01.712269: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_2431', 8 bytes spill stores, 8 bytes spill loads

2025-10-06 10:48:01.749912: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 760 bytes spill stores, 836 bytes spill loads

2025-10-06 10:48:01.788779: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_2431', 8 bytes spill stores, 8 bytes spill loads

2025-10-06 10:48:01.837035: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_11', 84 bytes spill stores, 84 bytes spill loads

2025-10-06 10:48:03.871531: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_31', 40 bytes spill stores, 40 bytes spill loads

2025-10-06 10:48:04.197106: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 760 bytes spill stores, 836 bytes spill loads

2025-10-06 10:48:06.365661: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 12 bytes spill stores, 12 bytes spill loads

2025-10-06 10:48:06.392828: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_10', 20 bytes spill stores, 20 bytes spill loads

2025-10-06 10:48:06.479910: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_10', 8 bytes spill stores, 8 bytes spill loads

2025-10-06 10:48:06.728763: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 816 bytes spill stores, 956 bytes spill loads

2025-10-06 10:48:59.394122: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 760 bytes spill stores, 836 bytes spill loads

2025-10-06 10:49:00.204478: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 12 bytes spill stores, 12 bytes spill loads

2025-10-06 10:49:00.236595: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_10', 8 bytes spill stores, 8 bytes spill loads

2025-10-06 10:49:00.274911: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_10', 20 bytes spill stores, 20 bytes spill loads

2025-10-06 10:49:00.540203: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 816 bytes spill stores, 956 bytes spill loads

                                                                                  [I 2025-10-06 10:49:00,964] Trial 3 finished with value: 139.1344055670631 and parameters: {'seq_len': 24, 'd_model': 128, 'heads': 8, 'ff_dim': 192, 'att_dropout': 0.18698943804826737, 'dropout': 0.13235920994105968, 'lr': 6.700183621677408e-05, 'batch': 256, 'epochs': 91}. Best is trial 1 with value: 133.44145925039564.
Best trial: 1. Best value: 133.441:   8%|▊         | 3/40 [02:21<16:55, 27.45s/it]Best trial: 1. Best value: 133.441:   8%|▊         | 3/40 [02:21<16:55, 27.45s/it]Best trial: 1. Best value: 133.441:  10%|█         | 4/40 [02:21<24:45, 41.26s/it]2025-10-06 10:49:03.638403: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 20 bytes spill stores, 20 bytes spill loads

2025-10-06 10:49:03.805240: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_11', 40 bytes spill stores, 40 bytes spill loads

2025-10-06 10:49:03.812993: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_11', 132 bytes spill stores, 132 bytes spill loads

2025-10-06 10:49:03.977300: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_11', 20 bytes spill stores, 20 bytes spill loads

2025-10-06 10:49:05.940632: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_31', 80 bytes spill stores, 80 bytes spill loads

2025-10-06 10:49:05.943995: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_31', 56 bytes spill stores, 56 bytes spill loads

2025-10-06 10:49:08.315917: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_10', 56 bytes spill stores, 56 bytes spill loads

2025-10-06 10:49:08.408234: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_10', 80 bytes spill stores, 80 bytes spill loads

2025-10-06 10:49:31.478420: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_10', 56 bytes spill stores, 56 bytes spill loads

2025-10-06 10:49:31.479249: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_10', 56 bytes spill stores, 56 bytes spill loads

2025-10-06 10:49:32.418132: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_10', 56 bytes spill stores, 56 bytes spill loads

2025-10-06 10:49:32.431324: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_10', 80 bytes spill stores, 80 bytes spill loads

                                                                                  [I 2025-10-06 10:49:32,938] Trial 4 finished with value: 133.31452178495036 and parameters: {'seq_len': 6, 'd_model': 96, 'heads': 2, 'ff_dim': 128, 'att_dropout': 0.15257120734941082, 'dropout': 0.3630265895704372, 'lr': 0.00015759936475969445, 'batch': 128, 'epochs': 46}. Best is trial 4 with value: 133.31452178495036.
Best trial: 1. Best value: 133.441:  10%|█         | 4/40 [02:53<24:45, 41.26s/it]Best trial: 4. Best value: 133.315:  10%|█         | 4/40 [02:53<24:45, 41.26s/it]Best trial: 4. Best value: 133.315:  12%|█▎        | 5/40 [02:53<22:06, 37.91s/it]                                                                                  [I 2025-10-06 10:49:49,082] Trial 5 finished with value: 132.05679856362943 and parameters: {'seq_len': 18, 'd_model': 64, 'heads': 2, 'ff_dim': 64, 'att_dropout': 0.1281323365878769, 'dropout': 0.32720590636899727, 'lr': 0.0026328806385787135, 'batch': 128, 'epochs': 57}. Best is trial 5 with value: 132.05679856362943.
Best trial: 4. Best value: 133.315:  12%|█▎        | 5/40 [03:09<22:06, 37.91s/it]Best trial: 5. Best value: 132.057:  12%|█▎        | 5/40 [03:09<22:06, 37.91s/it]Best trial: 5. Best value: 132.057:  15%|█▌        | 6/40 [03:09<17:17, 30.51s/it]2025-10-06 10:49:52.102135: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_2431', 24 bytes spill stores, 24 bytes spill loads

2025-10-06 10:49:52.206400: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_11', 136 bytes spill stores, 176 bytes spill loads

2025-10-06 10:49:52.264880: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_2431', 8 bytes spill stores, 8 bytes spill loads

2025-10-06 10:49:52.318927: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 760 bytes spill stores, 836 bytes spill loads

2025-10-06 10:49:52.320026: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_19', 8 bytes spill stores, 8 bytes spill loads

2025-10-06 10:49:52.360295: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_2431', 8 bytes spill stores, 8 bytes spill loads

2025-10-06 10:49:52.390317: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_11', 92 bytes spill stores, 92 bytes spill loads

2025-10-06 10:49:54.748249: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_31', 8 bytes spill stores, 8 bytes spill loads

2025-10-06 10:49:54.754254: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 12 bytes spill stores, 12 bytes spill loads

2025-10-06 10:49:54.794194: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_31', 20 bytes spill stores, 20 bytes spill loads

2025-10-06 10:49:55.321131: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 816 bytes spill stores, 956 bytes spill loads

2025-10-06 10:49:57.462078: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_10', 8 bytes spill stores, 8 bytes spill loads

2025-10-06 10:49:57.475111: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_10', 20 bytes spill stores, 20 bytes spill loads

2025-10-06 10:49:57.506334: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 12 bytes spill stores, 12 bytes spill loads

2025-10-06 10:49:57.734568: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 816 bytes spill stores, 956 bytes spill loads

2025-10-06 10:50:26.555934: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_10', 40 bytes spill stores, 40 bytes spill loads

2025-10-06 10:50:26.831851: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 760 bytes spill stores, 836 bytes spill loads

                                                                                  [I 2025-10-06 10:50:27,726] Trial 6 finished with value: 131.929890827477 and parameters: {'seq_len': 18, 'd_model': 128, 'heads': 2, 'ff_dim': 192, 'att_dropout': 0.15080370696865844, 'dropout': 0.02059150049999574, 'lr': 0.00018041096636818932, 'batch': 64, 'epochs': 79}. Best is trial 6 with value: 131.929890827477.
Best trial: 5. Best value: 132.057:  15%|█▌        | 6/40 [03:48<17:17, 30.51s/it]Best trial: 6. Best value: 131.93:  15%|█▌        | 6/40 [03:48<17:17, 30.51s/it] Best trial: 6. Best value: 131.93:  18%|█▊        | 7/40 [03:48<18:14, 33.17s/it]                                                                                 [I 2025-10-06 10:50:55,740] Trial 7 finished with value: 234.58667940923243 and parameters: {'seq_len': 6, 'd_model': 64, 'heads': 2, 'ff_dim': 64, 'att_dropout': 0.17726788295647253, 'dropout': 0.271025744736913, 'lr': 5.396916045063646e-05, 'batch': 256, 'epochs': 54}. Best is trial 6 with value: 131.929890827477.
Best trial: 6. Best value: 131.93:  18%|█▊        | 7/40 [04:16<18:14, 33.17s/it]Best trial: 6. Best value: 131.93:  18%|█▊        | 7/40 [04:16<18:14, 33.17s/it]Best trial: 6. Best value: 131.93:  20%|██        | 8/40 [04:16<16:48, 31.53s/it]2025-10-06 10:50:58.583144: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_31', 52 bytes spill stores, 52 bytes spill loads

2025-10-06 10:50:58.735336: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_31', 56 bytes spill stores, 56 bytes spill loads

2025-10-06 10:50:58.913861: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_11', 132 bytes spill stores, 132 bytes spill loads

2025-10-06 10:50:58.935348: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_11', 32 bytes spill stores, 32 bytes spill loads

2025-10-06 10:50:58.992234: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 4 bytes spill stores, 4 bytes spill loads

2025-10-06 10:50:58.999291: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_19', 4 bytes spill stores, 4 bytes spill loads

2025-10-06 10:50:59.032407: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_19', 8 bytes spill stores, 8 bytes spill loads

2025-10-06 10:50:59.162844: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_11', 48 bytes spill stores, 48 bytes spill loads

2025-10-06 10:51:01.144785: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_31', 80 bytes spill stores, 80 bytes spill loads

2025-10-06 10:51:01.183389: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_31', 56 bytes spill stores, 56 bytes spill loads

2025-10-06 10:51:01.375216: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 56 bytes spill stores, 56 bytes spill loads

2025-10-06 10:51:01.421620: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 64 bytes spill stores, 64 bytes spill loads

2025-10-06 10:51:03.375318: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_10', 56 bytes spill stores, 56 bytes spill loads

2025-10-06 10:51:03.392445: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_10', 80 bytes spill stores, 80 bytes spill loads

2025-10-06 10:51:03.443250: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 64 bytes spill stores, 64 bytes spill loads

2025-10-06 10:51:03.453892: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 56 bytes spill stores, 56 bytes spill loads

                                                                                 [I 2025-10-06 10:51:08,376] Trial 8 pruned. Trial was pruned at epoch 11.
Best trial: 6. Best value: 131.93:  20%|██        | 8/40 [04:28<16:48, 31.53s/it]Best trial: 6. Best value: 131.93:  20%|██        | 8/40 [04:28<16:48, 31.53s/it]Best trial: 6. Best value: 131.93:  22%|██▎       | 9/40 [04:28<13:14, 25.62s/it]2025-10-06 10:51:11.262453: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 24 bytes spill stores, 24 bytes spill loads

2025-10-06 10:51:13.072473: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 12 bytes spill stores, 12 bytes spill loads

2025-10-06 10:51:13.196902: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 32 bytes spill stores, 32 bytes spill loads

2025-10-06 10:51:14.990387: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 12 bytes spill stores, 12 bytes spill loads

2025-10-06 10:51:15.034609: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 32 bytes spill stores, 32 bytes spill loads

                                                                                 [I 2025-10-06 10:51:17,876] Trial 9 pruned. Trial was pruned at epoch 5.
Best trial: 6. Best value: 131.93:  22%|██▎       | 9/40 [04:38<13:14, 25.62s/it]Best trial: 6. Best value: 131.93:  22%|██▎       | 9/40 [04:38<13:14, 25.62s/it]Best trial: 6. Best value: 131.93:  25%|██▌       | 10/40 [04:38<10:19, 20.65s/it]2025-10-06 10:51:20.778664: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_11', 8 bytes spill stores, 8 bytes spill loads

2025-10-06 10:51:21.038014: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 432 bytes spill stores, 432 bytes spill loads

2025-10-06 10:51:23.332461: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 440 bytes spill stores, 440 bytes spill loads

2025-10-06 10:51:25.361076: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 440 bytes spill stores, 440 bytes spill loads

2025-10-06 10:51:46.182340: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 440 bytes spill stores, 440 bytes spill loads

                                                                                  [I 2025-10-06 10:51:46,944] Trial 10 finished with value: 132.0208464836141 and parameters: {'seq_len': 18, 'd_model': 32, 'heads': 4, 'ff_dim': 192, 'att_dropout': 0.23550885807204874, 'dropout': 0.01549007998447316, 'lr': 0.00415443048306104, 'batch': 64, 'epochs': 70}. Best is trial 6 with value: 131.929890827477.
Best trial: 6. Best value: 131.93:  25%|██▌       | 10/40 [05:07<10:19, 20.65s/it]Best trial: 6. Best value: 131.93:  25%|██▌       | 10/40 [05:07<10:19, 20.65s/it]Best trial: 6. Best value: 131.93:  28%|██▊       | 11/40 [05:07<11:13, 23.22s/it]                                                                                  [I 2025-10-06 10:52:09,620] Trial 11 finished with value: 132.6293737497467 and parameters: {'seq_len': 18, 'd_model': 32, 'heads': 4, 'ff_dim': 192, 'att_dropout': 0.2599609337918799, 'dropout': 0.007346617898812944, 'lr': 0.00386837743330195, 'batch': 64, 'epochs': 69}. Best is trial 6 with value: 131.929890827477.
Best trial: 6. Best value: 131.93:  28%|██▊       | 11/40 [05:30<11:13, 23.22s/it]Best trial: 6. Best value: 131.93:  28%|██▊       | 11/40 [05:30<11:13, 23.22s/it]Best trial: 6. Best value: 131.93:  30%|███       | 12/40 [05:30<10:45, 23.06s/it]                                                                                  [I 2025-10-06 10:52:26,364] Trial 12 finished with value: 133.2045463633843 and parameters: {'seq_len': 18, 'd_model': 32, 'heads': 4, 'ff_dim': 192, 'att_dropout': 0.22980199251780561, 'dropout': 0.018137961873729402, 'lr': 0.0015348685222884215, 'batch': 64, 'epochs': 71}. Best is trial 6 with value: 131.929890827477.
Best trial: 6. Best value: 131.93:  30%|███       | 12/40 [05:46<10:45, 23.06s/it]Best trial: 6. Best value: 131.93:  30%|███       | 12/40 [05:46<10:45, 23.06s/it]Best trial: 6. Best value: 131.93:  32%|███▎      | 13/40 [05:46<09:30, 21.14s/it]                                                                                  [I 2025-10-06 10:52:36,285] Trial 13 pruned. Trial was pruned at epoch 5.
Best trial: 6. Best value: 131.93:  32%|███▎      | 13/40 [05:56<09:30, 21.14s/it]Best trial: 6. Best value: 131.93:  32%|███▎      | 13/40 [05:56<09:30, 21.14s/it]Best trial: 6. Best value: 131.93:  35%|███▌      | 14/40 [05:56<07:41, 17.75s/it]                                                                                  [I 2025-10-06 10:52:55,855] Trial 14 finished with value: 132.850303443387 and parameters: {'seq_len': 18, 'd_model': 128, 'heads': 8, 'ff_dim': 192, 'att_dropout': 0.2996376880302051, 'dropout': 0.0653514373768068, 'lr': 0.0013695587977945345, 'batch': 64, 'epochs': 66}. Best is trial 6 with value: 131.929890827477.
Best trial: 6. Best value: 131.93:  35%|███▌      | 14/40 [06:16<07:41, 17.75s/it]Best trial: 6. Best value: 131.93:  35%|███▌      | 14/40 [06:16<07:41, 17.75s/it]Best trial: 6. Best value: 131.93:  38%|███▊      | 15/40 [06:16<07:37, 18.30s/it]                                                                                  [I 2025-10-06 10:53:24,299] Trial 15 finished with value: 131.24691216605822 and parameters: {'seq_len': 18, 'd_model': 32, 'heads': 2, 'ff_dim': 96, 'att_dropout': 0.12498382318543041, 'dropout': 0.21196884055580936, 'lr': 0.004548007664220133, 'batch': 64, 'epochs': 79}. Best is trial 15 with value: 131.24691216605822.
Best trial: 6. Best value: 131.93:  38%|███▊      | 15/40 [06:44<07:37, 18.30s/it]Best trial: 15. Best value: 131.247:  38%|███▊      | 15/40 [06:44<07:37, 18.30s/it]Best trial: 15. Best value: 131.247:  40%|████      | 16/40 [06:44<08:32, 21.35s/it]2025-10-06 10:53:27.166175: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_2431', 8 bytes spill stores, 8 bytes spill loads

2025-10-06 10:53:27.180448: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 76 bytes spill stores, 76 bytes spill loads

2025-10-06 10:53:27.211665: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 52 bytes spill stores, 52 bytes spill loads

2025-10-06 10:53:29.439446: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 72 bytes spill stores, 72 bytes spill loads

2025-10-06 10:53:29.479373: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 48 bytes spill stores, 48 bytes spill loads

2025-10-06 10:53:31.384453: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 72 bytes spill stores, 72 bytes spill loads

2025-10-06 10:53:31.385857: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 48 bytes spill stores, 48 bytes spill loads

                                                                                    [I 2025-10-06 10:53:36,623] Trial 16 pruned. Trial was pruned at epoch 5.
Best trial: 15. Best value: 131.247:  40%|████      | 16/40 [06:57<08:32, 21.35s/it]Best trial: 15. Best value: 131.247:  40%|████      | 16/40 [06:57<08:32, 21.35s/it]Best trial: 15. Best value: 131.247:  42%|████▎     | 17/40 [06:57<07:08, 18.64s/it]2025-10-06 10:53:39.530367: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 52 bytes spill stores, 52 bytes spill loads

2025-10-06 10:53:39.593604: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 76 bytes spill stores, 76 bytes spill loads

2025-10-06 10:53:41.781976: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_31', 8 bytes spill stores, 8 bytes spill loads

2025-10-06 10:53:41.867679: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 72 bytes spill stores, 72 bytes spill loads

2025-10-06 10:53:41.987633: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_31', 20 bytes spill stores, 20 bytes spill loads

2025-10-06 10:53:42.216242: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 48 bytes spill stores, 48 bytes spill loads

2025-10-06 10:53:44.041611: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 72 bytes spill stores, 72 bytes spill loads

2025-10-06 10:53:44.091152: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 48 bytes spill stores, 48 bytes spill loads

2025-10-06 10:54:02.140053: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 52 bytes spill stores, 52 bytes spill loads

2025-10-06 10:54:02.181559: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 76 bytes spill stores, 76 bytes spill loads

                                                                                    [I 2025-10-06 10:54:03,038] Trial 17 finished with value: 133.5225139021506 and parameters: {'seq_len': 12, 'd_model': 128, 'heads': 2, 'ff_dim': 96, 'att_dropout': 0.15653305631911868, 'dropout': 0.21603800804543755, 'lr': 0.00026718848574912627, 'batch': 64, 'epochs': 94}. Best is trial 15 with value: 131.24691216605822.
Best trial: 15. Best value: 131.247:  42%|████▎     | 17/40 [07:23<07:08, 18.64s/it]Best trial: 15. Best value: 131.247:  42%|████▎     | 17/40 [07:23<07:08, 18.64s/it]Best trial: 15. Best value: 131.247:  45%|████▌     | 18/40 [07:23<07:41, 20.98s/it]                                                                                    [I 2025-10-06 10:54:25,066] Trial 18 finished with value: 131.29645011385495 and parameters: {'seq_len': 24, 'd_model': 32, 'heads': 2, 'ff_dim': 96, 'att_dropout': 0.08836097952378665, 'dropout': 0.17931246566649828, 'lr': 0.0006618428327118367, 'batch': 64, 'epochs': 79}. Best is trial 15 with value: 131.24691216605822.
Best trial: 15. Best value: 131.247:  45%|████▌     | 18/40 [07:45<07:41, 20.98s/it]Best trial: 15. Best value: 131.247:  45%|████▌     | 18/40 [07:45<07:41, 20.98s/it]Best trial: 15. Best value: 131.247:  48%|████▊     | 19/40 [07:45<07:27, 21.29s/it]                                                                                    [I 2025-10-06 10:54:43,541] Trial 19 finished with value: 132.80544098887665 and parameters: {'seq_len': 24, 'd_model': 32, 'heads': 2, 'ff_dim': 96, 'att_dropout': 0.01623717352457832, 'dropout': 0.1752756366757143, 'lr': 0.0007043211741023973, 'batch': 64, 'epochs': 62}. Best is trial 15 with value: 131.24691216605822.
Best trial: 15. Best value: 131.247:  48%|████▊     | 19/40 [08:03<07:27, 21.29s/it]Best trial: 15. Best value: 131.247:  48%|████▊     | 19/40 [08:03<07:27, 21.29s/it]Best trial: 15. Best value: 131.247:  50%|█████     | 20/40 [08:03<06:48, 20.45s/it]                                                                                    [I 2025-10-06 10:55:04,314] Trial 20 finished with value: 132.32081043811664 and parameters: {'seq_len': 24, 'd_model': 32, 'heads': 2, 'ff_dim': 96, 'att_dropout': 0.0888063652940661, 'dropout': 0.22833995475020158, 'lr': 0.0021349505879704983, 'batch': 64, 'epochs': 76}. Best is trial 15 with value: 131.24691216605822.
Best trial: 15. Best value: 131.247:  50%|█████     | 20/40 [08:24<06:48, 20.45s/it]Best trial: 15. Best value: 131.247:  50%|█████     | 20/40 [08:24<06:48, 20.45s/it]Best trial: 15. Best value: 131.247:  52%|█████▎    | 21/40 [08:24<06:30, 20.54s/it]                                                                                    [I 2025-10-06 10:55:14,488] Trial 21 pruned. Trial was pruned at epoch 5.
Best trial: 15. Best value: 131.247:  52%|█████▎    | 21/40 [08:34<06:30, 20.54s/it]Best trial: 15. Best value: 131.247:  52%|█████▎    | 21/40 [08:34<06:30, 20.54s/it]Best trial: 15. Best value: 131.247:  55%|█████▌    | 22/40 [08:34<05:13, 17.43s/it]                                                                                    [I 2025-10-06 10:55:32,205] Trial 22 finished with value: 133.16593414092435 and parameters: {'seq_len': 24, 'd_model': 32, 'heads': 2, 'ff_dim': 96, 'att_dropout': 0.07769040606047072, 'dropout': 0.24984405808045818, 'lr': 0.0012595484960449008, 'batch': 64, 'epochs': 88}. Best is trial 15 with value: 131.24691216605822.
Best trial: 15. Best value: 131.247:  55%|█████▌    | 22/40 [08:52<05:13, 17.43s/it]Best trial: 15. Best value: 131.247:  55%|█████▌    | 22/40 [08:52<05:13, 17.43s/it]Best trial: 15. Best value: 131.247:  57%|█████▊    | 23/40 [08:52<04:57, 17.52s/it]                                                                                    [I 2025-10-06 10:55:43,777] Trial 23 pruned. Trial was pruned at epoch 5.
Best trial: 15. Best value: 131.247:  57%|█████▊    | 23/40 [09:04<04:57, 17.52s/it]Best trial: 15. Best value: 131.247:  57%|█████▊    | 23/40 [09:04<04:57, 17.52s/it]Best trial: 15. Best value: 131.247:  60%|██████    | 24/40 [09:04<04:11, 15.73s/it]2025-10-06 10:55:48.630409: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 8 bytes spill stores, 8 bytes spill loads

2025-10-06 10:55:50.206570: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 8 bytes spill stores, 8 bytes spill loads

                                                                                    [I 2025-10-06 10:55:54,355] Trial 24 pruned. Trial was pruned at epoch 5.
Best trial: 15. Best value: 131.247:  60%|██████    | 24/40 [09:14<04:11, 15.73s/it]Best trial: 15. Best value: 131.247:  60%|██████    | 24/40 [09:14<04:11, 15.73s/it]Best trial: 15. Best value: 131.247:  62%|██████▎   | 25/40 [09:14<03:32, 14.19s/it]                                                                                    [I 2025-10-06 10:56:20,987] Trial 25 finished with value: 131.09412619135534 and parameters: {'seq_len': 24, 'd_model': 32, 'heads': 8, 'ff_dim': 96, 'att_dropout': 0.10376183724747076, 'dropout': 0.39708234871401904, 'lr': 0.0030434470617868273, 'batch': 64, 'epochs': 76}. Best is trial 25 with value: 131.09412619135534.
Best trial: 15. Best value: 131.247:  62%|██████▎   | 25/40 [09:41<03:32, 14.19s/it]Best trial: 25. Best value: 131.094:  62%|██████▎   | 25/40 [09:41<03:32, 14.19s/it]Best trial: 25. Best value: 131.094:  65%|██████▌   | 26/40 [09:41<04:10, 17.92s/it]                                                                                    [I 2025-10-06 10:56:50,968] Trial 26 finished with value: 130.92029272375999 and parameters: {'seq_len': 24, 'd_model': 32, 'heads': 8, 'ff_dim': 96, 'att_dropout': 0.10491772630248755, 'dropout': 0.3963910655147282, 'lr': 0.004827891115632173, 'batch': 64, 'epochs': 86}. Best is trial 26 with value: 130.92029272375999.
Best trial: 25. Best value: 131.094:  65%|██████▌   | 26/40 [10:11<04:10, 17.92s/it]Best trial: 26. Best value: 130.92:  65%|██████▌   | 26/40 [10:11<04:10, 17.92s/it] Best trial: 26. Best value: 130.92:  68%|██████▊   | 27/40 [10:11<04:40, 21.54s/it]                                                                                   [I 2025-10-06 10:57:17,120] Trial 27 finished with value: 131.8642842210316 and parameters: {'seq_len': 24, 'd_model': 32, 'heads': 8, 'ff_dim': 96, 'att_dropout': 0.11164659137078874, 'dropout': 0.3897925807482304, 'lr': 0.002900269517320141, 'batch': 64, 'epochs': 88}. Best is trial 26 with value: 130.92029272375999.
Best trial: 26. Best value: 130.92:  68%|██████▊   | 27/40 [10:37<04:40, 21.54s/it]Best trial: 26. Best value: 130.92:  68%|██████▊   | 27/40 [10:37<04:40, 21.54s/it]Best trial: 26. Best value: 130.92:  70%|███████   | 28/40 [10:37<04:35, 22.92s/it]                                                                                   [I 2025-10-06 10:57:32,536] Trial 28 finished with value: 132.03212647638074 and parameters: {'seq_len': 24, 'd_model': 32, 'heads': 8, 'ff_dim': 96, 'att_dropout': 0.13461081921414292, 'dropout': 0.39790831479379274, 'lr': 0.004930649328687814, 'batch': 128, 'epochs': 61}. Best is trial 26 with value: 130.92029272375999.
Best trial: 26. Best value: 130.92:  70%|███████   | 28/40 [10:52<04:35, 22.92s/it]Best trial: 26. Best value: 130.92:  70%|███████   | 28/40 [10:52<04:35, 22.92s/it]Best trial: 26. Best value: 130.92:  72%|███████▎  | 29/40 [10:52<03:47, 20.67s/it]                                                                                   [I 2025-10-06 10:57:41,156] Trial 29 pruned. Trial was pruned at epoch 5.
Best trial: 26. Best value: 130.92:  72%|███████▎  | 29/40 [11:01<03:47, 20.67s/it]Best trial: 26. Best value: 130.92:  72%|███████▎  | 29/40 [11:01<03:47, 20.67s/it]Best trial: 26. Best value: 130.92:  75%|███████▌  | 30/40 [11:01<02:50, 17.06s/it]                                                                                   [I 2025-10-06 10:57:50,367] Trial 30 pruned. Trial was pruned at epoch 5.
Best trial: 26. Best value: 130.92:  75%|███████▌  | 30/40 [11:10<02:50, 17.06s/it]Best trial: 26. Best value: 130.92:  75%|███████▌  | 30/40 [11:10<02:50, 17.06s/it]Best trial: 26. Best value: 130.92:  78%|███████▊  | 31/40 [11:10<02:12, 14.70s/it]                                                                                   [I 2025-10-06 10:58:25,442] Trial 31 finished with value: 131.42840553415385 and parameters: {'seq_len': 24, 'd_model': 32, 'heads': 8, 'ff_dim': 96, 'att_dropout': 0.09869286095696933, 'dropout': 0.3642262763012858, 'lr': 0.004965504495741866, 'batch': 64, 'epochs': 85}. Best is trial 26 with value: 130.92029272375999.
Best trial: 26. Best value: 130.92:  78%|███████▊  | 31/40 [11:45<02:12, 14.70s/it]Best trial: 26. Best value: 130.92:  78%|███████▊  | 31/40 [11:45<02:12, 14.70s/it]Best trial: 26. Best value: 130.92:  80%|████████  | 32/40 [11:45<02:46, 20.81s/it]                                                                                   [I 2025-10-06 10:58:43,713] Trial 32 finished with value: 131.52008669068385 and parameters: {'seq_len': 24, 'd_model': 32, 'heads': 8, 'ff_dim': 96, 'att_dropout': 0.08104985226686043, 'dropout': 0.3250936693024108, 'lr': 0.002011056295532721, 'batch': 64, 'epochs': 75}. Best is trial 26 with value: 130.92029272375999.
Best trial: 26. Best value: 130.92:  80%|████████  | 32/40 [12:04<02:46, 20.81s/it]Best trial: 26. Best value: 130.92:  80%|████████  | 32/40 [12:04<02:46, 20.81s/it]Best trial: 26. Best value: 130.92:  82%|████████▎ | 33/40 [12:04<02:20, 20.05s/it]                                                                                   [I 2025-10-06 10:59:05,649] Trial 33 finished with value: 132.19814525693997 and parameters: {'seq_len': 24, 'd_model': 32, 'heads': 8, 'ff_dim': 96, 'att_dropout': 0.10581120554073059, 'dropout': 0.15397043428862223, 'lr': 0.0033879973439587766, 'batch': 64, 'epochs': 82}. Best is trial 26 with value: 130.92029272375999.
Best trial: 26. Best value: 130.92:  82%|████████▎ | 33/40 [12:26<02:20, 20.05s/it]Best trial: 26. Best value: 130.92:  82%|████████▎ | 33/40 [12:26<02:20, 20.05s/it]Best trial: 26. Best value: 130.92:  85%|████████▌ | 34/40 [12:26<02:03, 20.62s/it]2025-10-06 10:59:08.783358: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_31', 52 bytes spill stores, 52 bytes spill loads

2025-10-06 10:59:08.801122: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 52 bytes spill stores, 52 bytes spill loads

2025-10-06 10:59:08.819535: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 56 bytes spill stores, 56 bytes spill loads

2025-10-06 10:59:08.928837: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_31', 56 bytes spill stores, 56 bytes spill loads

2025-10-06 10:59:12.358614: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'input_add_multiply_reduce_fusion', 40 bytes spill stores, 24 bytes spill loads

                                                                                   [I 2025-10-06 10:59:40,217] Trial 34 finished with value: 131.57923735576597 and parameters: {'seq_len': 24, 'd_model': 96, 'heads': 8, 'ff_dim': 96, 'att_dropout': 0.029046932811349888, 'dropout': 0.2468791009878245, 'lr': 0.00247570667259, 'batch': 64, 'epochs': 74}. Best is trial 26 with value: 130.92029272375999.
Best trial: 26. Best value: 130.92:  85%|████████▌ | 34/40 [13:00<02:03, 20.62s/it]Best trial: 26. Best value: 130.92:  85%|████████▌ | 34/40 [13:00<02:03, 20.62s/it]Best trial: 26. Best value: 130.92:  88%|████████▊ | 35/40 [13:00<02:04, 24.80s/it]                                                                                   [I 2025-10-06 10:59:51,235] Trial 35 pruned. Trial was pruned at epoch 5.
Best trial: 26. Best value: 130.92:  88%|████████▊ | 35/40 [13:11<02:04, 24.80s/it]Best trial: 26. Best value: 130.92:  88%|████████▊ | 35/40 [13:11<02:04, 24.80s/it]Best trial: 26. Best value: 130.92:  90%|█████████ | 36/40 [13:11<01:22, 20.67s/it]2025-10-06 10:59:57.756298: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 8 bytes spill stores, 8 bytes spill loads

2025-10-06 11:00:07.104623: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 8 bytes spill stores, 8 bytes spill loads

                                                                                   [I 2025-10-06 11:00:07,484] Trial 36 finished with value: 132.02032129325772 and parameters: {'seq_len': 24, 'd_model': 32, 'heads': 8, 'ff_dim': 128, 'att_dropout': 0.12132967764330808, 'dropout': 0.3744359062195634, 'lr': 0.0016603863049636386, 'batch': 128, 'epochs': 88}. Best is trial 26 with value: 130.92029272375999.
Best trial: 26. Best value: 130.92:  90%|█████████ | 36/40 [13:27<01:22, 20.67s/it]Best trial: 26. Best value: 130.92:  90%|█████████ | 36/40 [13:27<01:22, 20.67s/it]Best trial: 26. Best value: 130.92:  92%|█████████▎| 37/40 [13:27<00:58, 19.34s/it]2025-10-06 11:00:10.865530: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 52 bytes spill stores, 52 bytes spill loads

2025-10-06 11:00:12.837947: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 48 bytes spill stores, 48 bytes spill loads

2025-10-06 11:00:14.570215: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 48 bytes spill stores, 48 bytes spill loads

2025-10-06 11:00:30.138549: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 48 bytes spill stores, 48 bytes spill loads

                                                                                   [I 2025-10-06 11:00:30,896] Trial 37 finished with value: 132.89110174076743 and parameters: {'seq_len': 6, 'd_model': 64, 'heads': 2, 'ff_dim': 96, 'att_dropout': 0.16830256254215545, 'dropout': 0.3408973433865041, 'lr': 0.0037721142684324313, 'batch': 64, 'epochs': 65}. Best is trial 26 with value: 130.92029272375999.
Best trial: 26. Best value: 130.92:  92%|█████████▎| 37/40 [13:51<00:58, 19.34s/it]Best trial: 26. Best value: 130.92:  92%|█████████▎| 37/40 [13:51<00:58, 19.34s/it]Best trial: 26. Best value: 130.92:  95%|█████████▌| 38/40 [13:51<00:41, 20.56s/it]2025-10-06 11:00:34.211417: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_31', 52 bytes spill stores, 52 bytes spill loads

2025-10-06 11:00:34.244231: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_31', 56 bytes spill stores, 56 bytes spill loads

2025-10-06 11:00:34.982364: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 4 bytes spill stores, 4 bytes spill loads

2025-10-06 11:00:36.989932: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_31', 56 bytes spill stores, 56 bytes spill loads

2025-10-06 11:00:37.018976: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_31', 56 bytes spill stores, 56 bytes spill loads

2025-10-06 11:00:37.071396: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 56 bytes spill stores, 56 bytes spill loads

2025-10-06 11:00:37.293706: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 64 bytes spill stores, 64 bytes spill loads

2025-10-06 11:00:39.403643: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 64 bytes spill stores, 64 bytes spill loads

2025-10-06 11:00:39.448172: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 56 bytes spill stores, 56 bytes spill loads

                                                                                   [I 2025-10-06 11:00:42,367] Trial 38 pruned. Trial was pruned at epoch 5.
Best trial: 26. Best value: 130.92:  95%|█████████▌| 38/40 [14:02<00:41, 20.56s/it]Best trial: 26. Best value: 130.92:  95%|█████████▌| 38/40 [14:02<00:41, 20.56s/it]Best trial: 26. Best value: 130.92:  98%|█████████▊| 39/40 [14:02<00:17, 17.84s/it]2025-10-06 11:00:45.889366: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 52 bytes spill stores, 52 bytes spill loads

2025-10-06 11:00:48.183522: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 48 bytes spill stores, 48 bytes spill loads

2025-10-06 11:00:50.080013: I external/local_xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:397] ptxas warning : Registers are spilled to local memory in function 'gemm_fusion_dot_6', 48 bytes spill stores, 48 bytes spill loads

                                                                                   [I 2025-10-06 11:00:53,104] Trial 39 pruned. Trial was pruned at epoch 5.
Best trial: 26. Best value: 130.92:  98%|█████████▊| 39/40 [14:13<00:17, 17.84s/it]Best trial: 26. Best value: 130.92:  98%|█████████▊| 39/40 [14:13<00:17, 17.84s/it]Best trial: 26. Best value: 130.92: 100%|██████████| 40/40 [14:13<00:00, 15.71s/it]Best trial: 26. Best value: 130.92: 100%|██████████| 40/40 [14:13<00:00, 21.34s/it]
/home/e.ladino/miniconda3/envs/e_ladino/lib/python3.12/site-packages/keras/src/saving/saving_lib.py:797: UserWarning: Skipping variable loading for optimizer 'adam', because it has 2 variables whereas the saved optimizer has 42 variables. 
  saveable.load_own_variables(weights_store.get(inner_path))
Best Transformer params: {'seq_len': 24, 'd_model': 32, 'heads': 8, 'ff_dim': 96, 'att_dropout': 0.10491772630248755, 'dropout': 0.3963910655147282, 'lr': 0.004827891115632173, 'batch': 64, 'epochs': 86}
Transformer test → RMSE: 138.0246 | MAE: 71.7022 | R2: 0.7131 | Skill: 0.297
Saved params → ../models/best_hpo_params_all.json

=== MLP ===
RMSE=135.5935 | MAE=66.8857 | R2=0.7228 | Skill=0.309

=== LSTM ===
RMSE=136.8780 | MAE=71.1631 | R2=0.7177 | Skill=0.303

=== BiLSTM ===
RMSE=136.8247 | MAE=70.5807 | R2=0.7180 | Skill=0.303

=== CNN-LSTM ===
RMSE=138.7057 | MAE=70.8367 | R2=0.7102 | Skill=0.294

=== Transformer ===
RMSE=138.0246 | MAE=71.7022 | R2=0.7131 | Skill=0.297

=== Test Summary ===
         model      RMSE      MAE      R2   Skill
0          MLP  135.5935  66.8857  0.7228  0.3092
2       BiLSTM  136.8247  70.5807  0.7180  0.3034
1         LSTM  136.8780  71.1631  0.7177  0.3031
4  Transformer  138.0246  71.7022  0.7131  0.2975
3     CNN-LSTM  138.7057  70.8367  0.7102  0.2938
